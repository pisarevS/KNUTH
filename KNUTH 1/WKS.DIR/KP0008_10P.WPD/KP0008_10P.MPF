
;************************************************
;KNUT MFD
;Wheel: KP-0008-10 MAVRITANIYA 1076
;last change: 11.03.2016 by DIS
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.4

N20 CALL "KP0008_10P_MA1_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N110 G97 M41 M3 S55
N120 DIAMOF
N130 G0 G40 G54 X=TREAD_DIAM+29+10 Z=WHEEL_HEIGHT+10
;****************
;OBOD
;****************
N140  G97 M3 S=35
N150  LIMS=25
N160 OFFN=0.3
N170 G1 G41 X=TREAD_DIAM+29 Z=WHEEL_HEIGHT F=1.43 M8 
N180  X=444-5 Z=WHEEL_HEIGHT F=1.643

N190 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(1)
N200  X=TREAD_DIAM+29
;************************************************
;CHERNOVOY PO GREBNU, #1 CUT
;************************************************
N210 OFFN=0.3
N220 G1 G42 X=TREAD_DIAM+29 Z=WHEEL_HEIGHT F=1.5 S=30
N230  X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966+5 F=1.23
N240 G1 X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966 F=1.23
;  PATH CTRL MODE TO CUT#2
N250 G0 G40 G603 G641 ADISPOS=15
N260  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
N270 G60 X=TREAD_DIAM+18.202-$P_TOOLR-0.5-3.5 Z=WHEEL_HEIGHT+2
;************************************************
;CHERNOVOY PO GREBNU, #2 CUT
;************************************************
N280 OFFN=0.5
N290 G1 G42 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT F=2 M8 S=30
N300        X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.726 F=1
N310 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6   F=2.0
N320 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.939
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N330 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N340  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N350 G96 M3 S=100 LIMS=35 
N360 G0 G40 X=444-10 M9

     ;GOTOF YABL_2

N370 OFFN=GLOBAL_ALLOWANCE+5
N380 G1 G41 X=444.0 Z=WHEEL_HEIGHT F=1 M7 M8
N390 Z=WHEEL_HEIGHT-4.5 F=1.2
N400 G3 X=384.091 Z=WHEEL_HEIGHT-53.508 CR=50
N410 G1 X=330.0 Z=WHEEL_HEIGHT-42.572
N420 X=300.0 Z=WHEEL_HEIGHT-36.507+0.5 F=1.2
N430 G4S2


N440 G0 G40 G603 G641 Z=WHEEL_HEIGHT+180
N450 G60 X=446.3-16 Z=WHEEL_HEIGHT+10

N460     YABL_2:

;************************************************
; CHERNOVOY PROHOD ##### OT YABLOKA #2
;************************************************

N470 OFFN=GLOBAL_ALLOWANCE
N480 G1 G41 X=444.0+2.3+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1.1 M7 M8
N490 G1 X=444.0+YABLOKO_VNUT Z=WHEEL_HEIGHT-2.3 F=1.1
N500 G3 X=384.091 Z=WHEEL_HEIGHT-53.508+DISK_VNUT CR=50
N510 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT  
N520 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT+0.3


N530 G0 G40 G603 G641 Z=WHEEL_HEIGHT+80+150 
N540 G97 M3  S=120 LIMS=120
;************************
;TORCOVKA STUPICY 1
;************************
N550 G60 X=157.02+40 Z=WHEEL_HEIGHT+47.5

N560 OFFN=6
N570 G96 M3 S=100 LIMS=85
N580 OFFN=GLOBAL_ALLOWANCE+6
N590 G1 G41 X=157.02+10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.95 M7 M8
N600 X=BORE_DIAM-10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.9; F=0.8
N610 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(8)  M9

N620 G0 G40 X=157.02+30



;************************
;TORCOVKA STUPICY 2
;************************
N550 G60 X=157.02+40 Z=WHEEL_HEIGHT+47.5

N560 OFFN=0
N570 G96 M3 S=100 LIMS=85
N580 OFFN=GLOBAL_ALLOWANCE
N590 G1 G41 X=157.02+10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=1.21 M7 M8
N600 X=BORE_DIAM-10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.9; F=0.8
N610 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(4)  M9

N620 G0 G40 X=157.02+10



N630 G96 M3 S=100 LIMS=80

 ;GOTOF STUP_2

;************************************************
;OT STUPICY 1
;************************************************

N640 OFFN=8+GLOBAL_ALLOWANCE
N650 G1 G42 X=157.02 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N660 X=167.160 Z=WHEEL_HEIGHT+19.64 F=0.6 ; F=1.1
N670 G2 X=211.652 Z=WHEEL_HEIGHT-18.646 CR=60  F=0.75 ;F=1.3
;N620 G1 X=330.0 Z=WHEEL_HEIGHT-42.572    ;;;;ZAKRIT' ETOT KADR ESLI PO DISKU MALO BERET

N680 G0 G40 G603 G641 Z=WHEEL_HEIGHT+47.5+VYLET_ST+250
N690 X=157.02+16 Z=WHEEL_HEIGHT+47.5+VYLET_ST+15

;************************************************
;CHERNOVOY OT STUPICY,## 2CUT
;************************************************

N700     STUP_2:

N710 LIMS=85

N720 OFFN=GLOBAL_ALLOWANCE
N730 G1 G42 X=157.02-0.3+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N740 X=157.02+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5-0.3 F=0.3
N750 X=167.160+STUPICA_VNUT+0.5 Z=WHEEL_HEIGHT+19.64 F=1.1
N760 G2 X=211.652 Z=WHEEL_HEIGHT-18.646+DISK_VNUT CR=60  F=0.85 ;F=1.1
;     G1 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT
N770 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT+0.1 F=1.0

;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N780 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N790  G153 D0 Z=700
N800  G153 G60 X=1000 M60 M9
N810 T20
N820 M6
N830 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N840 G0 G40 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651+5

N850 G97 M3 S=30
N860 G95 LIMS=RTOI(75/(2*3.14*(TREAD_DIAM+30)/1000))
N870    OFFN=0.3
N880 G1 G42 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651  F=1.3   M8
N890 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N900 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=0.6
N910 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 
N920 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N930     G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34
N940 G4 S1
N950 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N960  X=TREAD_DIAM+32 Z=TREAD_HEIGHT_S1+15.150
N970  Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO GREBNU
;************************************************
N980 G0 G40 X=444.0-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N990 G96 M3 M42 S=75
N1000 G95 LIMS=RTOI(120/(2*3.14*(TREAD_DIAM+30)/1000))
N1010 G0 Z=WHEEL_HEIGHT+10
N1020 G0 G60 Z=WHEEL_HEIGHT

N1030 OFFN=0
N1040 G1 G42 X=444.0 Z=WHEEL_HEIGHT F=1.8 M8 S=75
N1050 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT
N1060 X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.7695 F=0.7
N1070 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6
N1080 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N1090 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=0.6
N1100 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 
N1110 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N1100 M7 M8 M23 G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34
N1120 G97  M3 S200 LIMS=200 M23
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N1130 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N1140  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N1150  G153 D0 Z=800
N1160  G60 G153 X=1000 
;************************************************
;MACHINING CH1 FINISHED, WAIT FOR FINISHING CH2
;************************************************
N1170 G4 F6
N1180 M9
N1190 SPOS=133
N1200    M5
N1210 G4F4
N1220 M52 

N1230 M56
N1240 MSG("OBRABOTKA V/S ZAVERSHENA")
;*********************
;*POSICITION N/S*
;*********************
N1250 M0

N1260 M51
N1270 G97 M41 M3 S5
N1280 SPOS=235
N1290 M5
N1300 G4F4
N1310 M52

N1320 MSG("ZAGRUZKA N/S")
N1330 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1340 G18 G90 G95 F=1.2

N1350   N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1360 M51 
N1370    M56

N1380 T20
N1390 M6
N1400 DIAMOF

;CALL ZERO POINT SHIFT
N1410 G55
N1420 DIAMOF
N1430  G97 M41 M3 S=10
N1440 M0
N1450 G97 M41 M3 S30
N1460 G0 G40 X=TREAD_DIAM+18 Z=WHEEL_HEIGHT


N1470  G95 LIMS=20
;************************************************
;TORCOVKA OBODA
;************************************************
N1480 OFFN=TREAD_ALLOWANCE
N1490 G1 G41 X=TREAD_DIAM Z=WHEEL_HEIGHT F=1.2  M8
N1500 X=444-15 Z=WHEEL_HEIGHT  F=1.5

N1510 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(2.0)
N1520 X=TREAD_DIAM
;************************************************
;CHERNOVOY PO KRUGU KATANIYA
;************************************************
N1530 OFFN=GLOBAL_ALLOWANCE+0.3
N1540 G1 G42 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1.3 M7 M8
N1550    X=TREAD_DIAM-1 Z=WHEEL_HEIGHT-5
N1560    X=TREAD_DIAM Z=TREAD_HEIGHT_S2
N1570    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354
N1580   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34
N1590 G4 S1

N1600 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1610  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10
N1620 G60 X=TREAD_DIAM-10 Z=WHEEL_HEIGHT+50



;************************************************
;CHISTOVOY PO KRUGU KATANIYA
;************************************************
N1630 OFFN=GLOBAL_ALLOWANCE
N1640 G0 G40 X=440-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N1650 G97 M3 S=75
N1660 G95 LIMS=RTOI(165/(2*3.14*TREAD_DIAM/1000))

N1670 G0 Z=WHEEL_HEIGHT+10

N1680      G1 G42 X=444-5 Z=WHEEL_HEIGHT F=1.2
N1690 G1 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1.2 M7 M8
N1700    X=TREAD_DIAM-1 Z=WHEEL_HEIGHT-5
N1710    X=TREAD_DIAM Z=TREAD_HEIGHT_S2
N1720    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354
N1730   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34


N1740 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1750  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10

;************************************************
;TOOL CHANGE T125
;************************************************
N1760 SUPA G0 G40 D0 X=1000 Z=700  OFFN=0 M9

N1770 T125
N1780 M6
N1790 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1800 G96 M3 S=80 
N1810 G0 G40  X=444-$P_TOOLR Z=WHEEL_HEIGHT+8

N1820 OFFN=6+GLOBAL_ALLOWANCE
N1830 G1 G41 X=447.77 Z=WHEEL_HEIGHT F=1.0 M7 M8 
N1840 X=441.25 Z=119.000 F=1.0
N1850 G3 X=403.533 Z=90.126 CR=50 F=1.1
N1860 G1 X=289.069 Z=71.839 F=1.0
N1870 G4S1 

N1880 G0 G40 G603 G641 Z=WHEEL_HEIGHT+210
N1890 X=447.77+0.3-16 Z=WHEEL_HEIGHT+10



;************************************************
;OT YABLOKA_2
;************************************************
N1900 OFFN=GLOBAL_ALLOWANCE
N1910 G1 G41 X=447.77+YABLOKO_NAR+0.3-1 Z=WHEEL_HEIGHT F=0.6 M7 M8 
N1920 X=447.77+YABLOKO_NAR-1 Z=WHEEL_HEIGHT-0.3
N1930 X=441.25+YABLOKO_NAR Z=119.000 F=1.2
N1940 G3 X=403.533 Z=90.126+DISK_NAR CR=50 F=1.3
N1950 G1 X=346.301 Z=80.982+DISK_NAR F=1.1
N1960 X=304.069 Z=74.235+DISK_NAR+0.3 F=1.1      ;+0.5

N1970 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200



;************************************************
;MOVE TO OUTER BOTTOM #2
;************************************************
N1980 G96 M3  S=110 LIMS=120
N1990 G60 X=158.5+40 Z=122+15

;************************************************
;TORCOVKA STUPICY 1
;************************************************
N2000 OFFN=6
N2010 G1 G41 X=158.5+20 Z=122 F=1.0 M8
N2020  X=BORE_DIAM-10 Z=122 F=0.7 ; F=1.1

N2030 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(8)
N2040  X=158.5+40 Z=122+15

;************************************************
;TORCOVKA STUPICY 2
;************************************************
N2050 OFFN=0
N2060 G1 G41 X=158.5+20 Z=122 F=1.1 M8
N2070  X=BORE_DIAM-10 Z=122 F=1.1

N2080 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3)

N2090  X=158.5+7  Z=122+7

;************************************************
;OT STUPICY 
;************************************************
N2100 G96 M3  S=110 LIMS=80
N2110 OFFN=0
N2120 OFFN=6+GLOBAL_ALLOWANCE
N2130 G1 G42 X=158.5 Z=122.0 F=1.2 M7M8
N2140    X=165.989 Z=101.422 F=1.2
N2150 G2 X=231.836 Z=62.695 CR=60  F=0.7 ;F=1.3
N2160 G1 X=289.069 Z=71.839  F=1.0 ;F=1.2


N2170 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2180 Z=122.0+GLOBAL_ALLOWANCE+50
N2190 X=BORE_DIAM-20
N2200 G60 Z=122.0+GLOBAL_ALLOWANCE
N2210 STOPRE

;****************************
;OT STUPICY # 2
;****************************
N2220 G96 S=100 M3
N2230 LIMS=90

N2240 M816 M28
N2250 OFFN=GLOBAL_ALLOWANCE
N2260 G1 G42 X=BORE_DIAM-12 Z=122.0 F=1.1 M7M8
N2270 X=154.99+STUPICA_NAR Z=122.0 F=1
N2280 G3 X=159.6974+STUPICA_NAR Z=118.7101 CR=5 F=0.91
N2290 G1 X=165.989+STUPICA_NAR Z=101.422  F=0.9 ;F=1
N2300 G2 X=231.836 Z=62.695+DISK_NAR CR=60 F=1.1 ; F=1.2
N2310 G1 X=346.3013 Z=80.982+DISK_NAR+0.1 F=1.1

;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2320 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2330  G153 D0 Z=700
N2340  G60 G153 X=1000 M9


N2350 T5 D1
N2360 M6
N2370 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
N2380  M42
N2390  M3 G97 S=160 LIMS=180
;-----------------------------
;N2370   GOTOF RASTOCHKA_2
;------------------------------
N2400 G97 M3 S=130

N2410 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=122+GLOBAL_ALLOWANCE+15


N2420 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-6 Z=122+GLOBAL_ALLOWANCE+3 F=0.9 M7 M8
N2430 Z=-47.5-10 F=0.6


N2440 M23 G0 G40 X=IC(-4) 
N2450 Z=122+GLOBAL_ALLOWANCE+5 M9

;***********************
N2460 RASTOCHKA_2:
;***********************
N2460      G97 M3 S=150
N2470 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+5

N2480 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+3 F=1.2 M7 M8
N2490       M858
N2500 Z=-47.5+1.5 F=1.2
N2510  M7 M8 M23 Z=-47.5-10 F=1.2 M200
N2520 X=BORE_DIAM-GLOBAL_ALLOWANCE+2.4 F=3
N2530 G4S6



N2540 G0 G40 X=IC(-4)
N2550 Z=122+GLOBAL_ALLOWANCE+5 M9
N2560 X=BORE_DIAM-GLOBAL_ALLOWANCE+1

N2570 G1 X=BORE_DIAM+GLOBAL_ALLOWANCE+1 Z=122+GLOBAL_ALLOWANCE F=1
N2580 X=BORE_DIAM+GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE-1 F=0.5
N2590 G4S2
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N2470 G0 G40 Z=IC(50)
N2480 SUPA D0 X=1000 Z=800
N2490 G97 M3 S=5
N2500  M41
N2510     G4 F3
N2520  SPOS=235
N2530       M5
N2540      G4 F3
N2550  M52
N2560 T125
N2570 M6
N2580 D1
N2590 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N2560 M2
