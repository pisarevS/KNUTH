;************************************************
;KNUT MFD
;Wheel: KP0040-16
;last change: 15.02.2018
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0040_16P_MA4_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N110 DIAMOF
N120 G0 G40 G54 X=394.5-10 Z=WHEEL_HEIGHT+14
;******************
;OBOD+GREBENJ
;******************
N130  G97 M3 S=55
N140 OFFN=GLOBAL_ALLOWANCE
N150 G1 G42 X=394.5-7 Z=WHEEL_HEIGHT F=1 M8 
N160   X=394.5+40 Z=WHEEL_HEIGHT F=1.5
N170   X=TREAD_DIAM+9.519 Z=WHEEL_HEIGHT  
N180 G3 X=TREAD_DIAM+25.149 Z=TREAD_HEIGHT_S1+62.766 CR=20.5 
N190    X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.75 CR=12
N200 G1 X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.5
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N210 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N220  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N230 G96 M3  S=150 LIMS=150
N240 G0 G40 X=394.5-10 M9
;************************************************
;OT YABLOKA
;************************************************
N250 OFFN=GLOBAL_ALLOWANCE
N260 G1 G41 X=394.5+0.424+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1.4 M8
N270  X=394.5-0.078+YABLOKO_VNUT Z=WHEEL_HEIGHT-0.29
N280  X=386.807+YABLOKO_VNUT Z=WHEEL_HEIGHT-28.709 F=1.5
N290 G3 X=368.988+YABLOKO_VNUT Z=WHEEL_HEIGHT-50.785+DISK_VNUT CR=35 F=1.5
N300   X=336.908 Z=WHEEL_HEIGHT-66.777+DISK_VNUT CR=1500
N310 G2 X=312.205 Z=WHEEL_HEIGHT-85.841+DISK_VNUT CR=76 
N320 G3 X=270 Z=WHEEL_HEIGHT-105.3+DISK_VNUT CR=55.5 
N330   X=260.054 Z=WHEEL_HEIGHT-104.402+0.2 CR=55.5
N340 G4 S1 

N350 G0 G40 G603 G641 Z=WHEEL_HEIGHT+60+150 M9
N360 G97 M3 M42 S=150 LIMS=150
;************************
;TORCOVKA STUPICY
;************************
N370 G60 X=130.5+20 Z=WHEEL_HEIGHT+60+VYLET_ST+8

N380 OFFN=GLOBAL_ALLOWANCE
N390 G97 M3 S=120 LIMS=140
N400 G1 G41 X=130.5+5 Z=WHEEL_HEIGHT+60+VYLET_ST F=1 M8 
N410  X=BORE_DIAM-15 Z=WHEEL_HEIGHT+60+VYLET_ST F=0.7

N420 G0 G40 Z=WHEEL_HEIGHT+60+100
N430 G0 G40 X=130.5+10 M9
N440   Z=WHEEL_HEIGHT+60+10
N450 G96 M3 S=150 LIMS=150
;************************************************
;OT STUPICY #1
;************************************************
;N480 OFFN=5+GLOBAL_ALLOWANCE
;N490 G1 G42 X=130.5 Z=WHEEL_HEIGHT+60 F=1.0 M8
;N500    X=142.777 Z=WHEEL_HEIGHT-17.511 F=1.0
;N510 G2 X=169.458 Z=WHEEL_HEIGHT-51.817 CR=45 F=1.3
;N520 G3 X=201.632 Z=WHEEL_HEIGHT-66.090 CR=1500 F=1.2
;N530   X=227.795 Z=WHEEL_HEIGHT-85.841 CR=76
;N540  G2 X=260.054 Z=WHEEL_HEIGHT-104.402 CR=55.5

N460  G0 G40 Z=WHEEL_HEIGHT+60+5+GLOBAL_ALLOWANCE
N470      X=130.5+10 M9
;************************************************
N480 OT_STUPICY_2:
;************************************************
N490 G97 M3 S=140 LIMS=150
N500 OFFN=GLOBAL_ALLOWANCE
N510 G1 G42 X=130.5-0.1+STUPICA_VNUT Z=WHEEL_HEIGHT+60+VYLET_ST F=1.0 M8
N520   X=130.5+0.057+STUPICA_VNUT Z=WHEEL_HEIGHT+60+VYLET_ST-0.356
N530   X=142.777+STUPICA_VNUT Z=WHEEL_HEIGHT-17.511 F=1.5 M23
N540 G2 X=169.458+STUPICA_VNUT Z=WHEEL_HEIGHT-51.817+DISK_VNUT CR=45 F=1.6 
N550 G3 X=201.632 Z=WHEEL_HEIGHT-66.090+DISK_VNUT CR=1500 F=1.8
N560    X=227.795 Z=WHEEL_HEIGHT-85.841+DISK_VNUT CR=76
N570 G2 X=260.054 Z=WHEEL_HEIGHT-104.402+DISK_VNUT CR=55.5 
N580    X=270 Z=WHEEL_HEIGHT-105.3+DISK_VNUT+0.07 CR=55.5
;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N590 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N600  G153 D0 Z=700
N610 M5
N620  G153 G60 X=1000 M60 M9
N630 T20
N640 M6
N650 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N660 G0 G40 X=TREAD_DIAM+28+5 Z=TREAD_HEIGHT_S1+59.5+5 M41 M3
N670 G97 M3  S=60
N680 OFFN=GLOBAL_ALLOWANCE
N690 G1 G42 X=TREAD_DIAM+28 Z=TREAD_HEIGHT_S1+54.75+3 F=1.5 
N700 G1 X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.5 F=1.1 M8
N710 G3 X=TREAD_DIAM+26.748 Z=TREAD_HEIGHT_S1+49.163 CR=12
N720    X=TREAD_DIAM+15.675 Z=TREAD_HEIGHT_S1+39.265 CR=20 
N730 G1 X=TREAD_DIAM+12.001 Z=TREAD_HEIGHT_S1+37.927 
N740 G2   X=TREAD_DIAM+6.867 Z=TREAD_HEIGHT_S1+34.5 CR=17 F=1
N750 G1   X=TREAD_DIAM+4.114+0.5 Z=TREAD_HEIGHT_S1+30.0-0.5
N760 G1   X=TREAD_DIAM+3.576 Z=TREAD_HEIGHT_S1+28.5 
N770    X=TREAD_DIAM+3.129 Z=TREAD_HEIGHT_S1+27.0 F=1.5
N780    X=TREAD_DIAM+2.741 Z=TREAD_HEIGHT_S1+25.5
N790    X=TREAD_DIAM+2.401 Z=TREAD_HEIGHT_S1+24.0
N800    X=TREAD_DIAM+2.101 Z=TREAD_HEIGHT_S1+22.5
N810 G1  X=TREAD_DIAM+1.834 Z=TREAD_HEIGHT_S1+21.0
N820 G1  X=TREAD_DIAM+1.597 Z=TREAD_HEIGHT_S1+19.5
N830    X=TREAD_DIAM+1.384 Z=TREAD_HEIGHT_S1+18.0
N840    X=TREAD_DIAM+1.193 Z=TREAD_HEIGHT_S1+16.5
N850 G4 S1
;N870 M42
;N880 G97 M3 S=200 M23
;N890  G4S20
;************************************************
;GO TO HOME POSITION
;************************************************
N910 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N920  X=TREAD_DIAM+50
;N870 M42
;N880 G97 M3 S=200 M23
;N890  G4S10
N891 Z=TREAD_HEIGHT_S1+15.150 M9
N930  G153 D0 Z=800  
N940  G60 G153 X=1000 M9
;************************************************
;MACHINING FINISHED
;************************************************
N950 M5 
N960 SPOS=133
N970    M5
N980 G4F3
N990 M52 

N1000 M56
;*********************
;*POSICITION N/S*
;*********************
N1010 M0

N1020 M51
N1030 
N1040 SPOS=236
N1050 M5
N1060 G4F3
N1070 M52

N1080 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1090 G18 G90 G95 F=1.2

N1100  N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1110 M51 
N1120    M56

N1130 T20
N1140 M6
N1150 DIAMOF

;CALL ZERO POINT SHIFT
N1160 G55
N1170 DIAMOF
N1180  G97 M41 M3 S=10
N1190 M0
N1200  G97 M41 M3 S=65
N1210 G0 G40 X=TREAD_DIAM+5 Z=WHEEL_HEIGHT+5

N1220  G95 LIMS=80
N1230  G97 M3 S=80 LIMS=85
;************************************************
;CHERNOVOY_PO_KRUGU_KATANIYA
;************************************************
N1240 OFFN=GLOBAL_ALLOWANCE
N1250 G1 G42 X=TREAD_DIAM-3.644+1-10 Z=WHEEL_HEIGHT+10 F=1 M8
N1260    X=TREAD_DIAM-2.644+1 Z=WHEEL_HEIGHT-1
N1270    X=TREAD_DIAM-0.780 Z=TREAD_HEIGHT_S2+32.158+5 F=1.25
N1280  X=TREAD_DIAM Z=TREAD_HEIGHT_S2+5 F=1.4
N1290  X=TREAD_DIAM+0.035 Z=TREAD_HEIGHT_S2-0.5+5
N1300  X=TREAD_DIAM+0.054 Z=TREAD_HEIGHT_S2-1.0+5
N1310  X=TREAD_DIAM+0.074 Z=TREAD_HEIGHT_S2-1.5+5
N1320  X=TREAD_DIAM+0.094 Z=TREAD_HEIGHT_S2-2.0+5
N1330  X=TREAD_DIAM+0.116 Z=TREAD_HEIGHT_S2-2.5+5
N1340  X=TREAD_DIAM+0.138 Z=TREAD_HEIGHT_S2-3.0+5
N1350  X=TREAD_DIAM+0.161 Z=TREAD_HEIGHT_S2-3.5+5
N1360  X=TREAD_DIAM+0.185 Z=TREAD_HEIGHT_S2-4.0+5
N1370  X=TREAD_DIAM+0.211 Z=TREAD_HEIGHT_S2-4.5+5
N1380  X=TREAD_DIAM+0.237 Z=TREAD_HEIGHT_S2-5.0+5
N1390  X=TREAD_DIAM+0.264 Z=TREAD_HEIGHT_S2-5.5+5
N1400  X=TREAD_DIAM+0.292 Z=TREAD_HEIGHT_S2-6.0+5
N1410  X=TREAD_DIAM+0.322 Z=TREAD_HEIGHT_S2-6.5+5
N1420  X=TREAD_DIAM+0.352 Z=TREAD_HEIGHT_S2-7.0+5
N1430  X=TREAD_DIAM+0.384 Z=TREAD_HEIGHT_S2-7.5+5 F=1.5
N1440  X=TREAD_DIAM+0.417 Z=TREAD_HEIGHT_S2-8.0+5
N1450  X=TREAD_DIAM+0.451 Z=TREAD_HEIGHT_S2-8.5+5
N1460  X=TREAD_DIAM+0.486 Z=TREAD_HEIGHT_S2-9.0+5
N1470  X=TREAD_DIAM+0.523 Z=TREAD_HEIGHT_S2-9.5+5
N1480  X=TREAD_DIAM+0.561 Z=TREAD_HEIGHT_S2-10.0+5
N1490  X=TREAD_DIAM+0.600 Z=TREAD_HEIGHT_S2-10.5+5
N1500  X=TREAD_DIAM+0.640 Z=TREAD_HEIGHT_S2-11.0+5
N1510  X=TREAD_DIAM+0.682 Z=TREAD_HEIGHT_S2-11.5+5
N1520  X=TREAD_DIAM+0.726 Z=TREAD_HEIGHT_S2-12.0+5
N1530  X=TREAD_DIAM+0.771 Z=TREAD_HEIGHT_S2-12.5+5
N1540  X=TREAD_DIAM+0.818 Z=TREAD_HEIGHT_S2-13.0+5
N1550  X=TREAD_DIAM+0.866 Z=TREAD_HEIGHT_S2-13.5+5
N1560  X=TREAD_DIAM+0.916 Z=TREAD_HEIGHT_S2-14.0+5
N1570  X=TREAD_DIAM+0.967 Z=TREAD_HEIGHT_S2-14.5+5
N1580  X=TREAD_DIAM+1.021 Z=TREAD_HEIGHT_S2-15.0+5
N1590  X=TREAD_DIAM+1.076 Z=TREAD_HEIGHT_S2-15.5+5
N1600  X=TREAD_DIAM+1.134 Z=TREAD_HEIGHT_S2-16.0+5
N1610  X=TREAD_DIAM+1.193 Z=TREAD_HEIGHT_S2-16.5+5
N1620  X=TREAD_DIAM+1.254 Z=TREAD_HEIGHT_S2-17.0+5
N1630  X=TREAD_DIAM+1.318 Z=TREAD_HEIGHT_S2-17.5+5
N1640  X=TREAD_DIAM+1.384 Z=TREAD_HEIGHT_S2-18.0+5
N1650  X=TREAD_DIAM+1.452 Z=TREAD_HEIGHT_S2-18.5+5
N1660  X=TREAD_DIAM+1.523 Z=TREAD_HEIGHT_S2-19.0+5
N1670  X=TREAD_DIAM+1.597 Z=TREAD_HEIGHT_S2-19.5+5
N1680  X=TREAD_DIAM+1.673 Z=TREAD_HEIGHT_S2-20.0+5
N1690  X=TREAD_DIAM+1.752 Z=TREAD_HEIGHT_S2-20.5+5
N1700  X=TREAD_DIAM+1.834 Z=TREAD_HEIGHT_S2-21.0+5
N1710  X=TREAD_DIAM+1.920 Z=TREAD_HEIGHT_S2-21.5+5
N1720  X=TREAD_DIAM+2.008 Z=TREAD_HEIGHT_S2-22.0+5
N1730  X=TREAD_DIAM+2.101 Z=TREAD_HEIGHT_S2-22.5+5
N1740  X=TREAD_DIAM+2.197 Z=TREAD_HEIGHT_S2-23.0+5
N1750  X=TREAD_DIAM+2.297 Z=TREAD_HEIGHT_S2-23.5+5
N1760 G4 S1

N1770 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1780  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+50
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T125
;************************************************
N1790 G153 D0 Z=800  M9
N1800 G60 G153 X=1000
N1810 T125
N1820 M6
N1830 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1840 G96 M3 S=120 LIMS=85
N1850 G0 G40  X=394.5-$P_TOOLR Z=WHEEL_HEIGHT+8

N1860 OFFN=5+GLOBAL_ALLOWANCE
N1870 G1 G41 X=394.5 Z=WHEEL_HEIGHT F=1.0 M8
N1880    X=394.5 Z=112.336+5 F=1.3
N1890 G3 X=364.5 Z=82.336+5+2 CR=30 F=1
N1900 G4S1

N1910 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N1920 G0 G40  X=394.5-$P_TOOLR Z=WHEEL_HEIGHT+8 M9
;************************************************
N1930  OT_YABLOKA_2:
;************************************************
N1840 G96 M3 S=130 LIMS=85
N1940 OFFN=GLOBAL_ALLOWANCE
N1950 G1 G41 X=394.5+0.3+YABLOKO_NAR Z=WHEEL_HEIGHT F=1.0 M8
N1960    X=394.5+YABLOKO_NAR Z=WHEEL_HEIGHT-0.3
N1970    X=394.5+YABLOKO_NAR Z=112.336+DISK_NAR+5 F=1.1 M23
N1980 G3 X=364.5+YABLOKO_NAR Z=82.336+DISK_NAR+5 CR=30 F=0.85
N1990   X=352.725 Z=84.109+DISK_NAR+0.2+5 CR=40
N2000 G4S1

N2010 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200 M9

N2020    X=212.175-10
N2030    G60 Z=126.3+DISK_NAR+GLOBAL_ALLOWANCE+5
;************************************************
;K YABLOKU
;************************************************
N1840 G97 M3 S=70 LIMS=85
N2040 OFFN=GLOBAL_ALLOWANCE
N2050 G1 G42 X=270.000 Z=126.3+DISK_NAR+5 F=1.4 M8
N2060 G3 X=327.280 Z=100.508+DISK_NAR+5 CR=76.5 F=1.1
N2070 G2 X=352.724 Z=84.109+DISK_NAR+5 CR=56 F=1.27
N2080    X=364.5+YABLOKO_NAR Z=82.336+DISK_NAR+0.3+5 CR=40 F=1.4
;************************************************
;PATH CONTROL MODE TO BOTTOM #3 OUTSIDE-INSIDE
;************************************************
N2090 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2100    Z=126.3+GLOBAL_ALLOWANCE+200
N2110    G60 X=270.0+6 Z=126.3+DISK_NAR+GLOBAL_ALLOWANCE+0.5+5
;************************************************
;PO DISKU K STUPICE
;************************************************
N2120 G97  M3 S=80 LIMS=150
N2130 OFFN=GLOBAL_ALLOWANCE
N2140 G1 G41 X=270.0+4 Z=126.3+0.2+DISK_NAR+5 F=1.4
N2150 G1 X=270.0 Z=126.3+0.05+DISK_NAR+5 F=1.3
N2160 G2 X=212.175 Z=99.886+DISK_NAR+5 CR=76.5 F=0.9
N2170 G3 X=170.177 Z=80.551+DISK_NAR+0.02+5 CR=56 

N2180 G0 G40 Z=WHEEL_HEIGHT+200 M42

N2190 G97 M3 S=136 LIMS=140 M9 
N2200 G60 X=134+25 Z=120+30 
;************************************************
N2210 OFFN=5+GLOBAL_ALLOWANCE
N2220 G1 G41 X=134+10 Z=120+10 F=1 M8
N2230  X=BORE_DIAM-12 Z=120+10 F=1

N2240 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(9+GLOBAL_ALLOWANCE)
N2250  X=134+25 M9
N2260  Z=120+15 
; ***********************************************
N2270 TORCOVKA_STUPICY_2:
;***********************************************
N2280 OFFN=GLOBAL_ALLOWANCE
N2290 G1 G41 X=134+10 Z=120+10 F=0.8 M8
N2300  X=BORE_DIAM-17 Z=120+10 F=1

N2310 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3+GLOBAL_ALLOWANCE)

N2320  X= 134+10 M9
N2330 G97 M3  S=136 LIMS=140
;************************************************
;OT STUPICY_1
;************************************************
N2340 OFFN=5+GLOBAL_ALLOWANCE
N2350 G1 G42 X=134.0 Z=120+10 F=1.0 M8
N2360    X=142.103 Z=99.515+5 F=1.3
N2370 G2 X=170.177 Z=80.551+5 CR=30 F=1.4

N2380 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N2390 G0 G40  X=134+10 Z=120+17 M9
;************************************************
N2400   OT_STUPICY_2:
;************************************************
N2410 OFFN=GLOBAL_ALLOWANCE
N2420 G1 G42 X=134-0.3+STUPICA_NAR Z=120+10 F=1.3 M8
N2430    X=134+0.196+STUPICA_NAR Z=120-0.496+10 F=1.0
N2440    X=142.103+STUPICA_NAR Z=99.515+5 F=1.4
N2450 G2 X=170.177+STUPICA_NAR Z=80.551+DISK_NAR+5 CR=30 F=1.3 M23
N2460 G2 X=184.973 Z=82.631+DISK_NAR+0.05+5 CR=56 F=1.25
;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2470 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2480  G153 D0 Z=700
N2490  G60 G153 X=1000 M9
N2500 G97 M3 S=170 LIMS=170
N2510 T5 D1
N2520 M6
N2530 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
;N840  M42
N2540 M3 G97 S=165 LIMS=220
;************************************************
;RASTOCHKA, 1 CUT
;************************************************
N2550 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=120+GLOBAL_ALLOWANCE+15 M23

N2560 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=120+GLOBAL_ALLOWANCE+5 F=1 M8
N2570  Z=-60-1.5 F=1
N2580  Z=-60-10 F=1.2

N2590 G0 G40 X=IC(-8) M9
N2600    Z=120+GLOBAL_ALLOWANCE+10+5
N2610    X=BORE_DIAM-GLOBAL_ALLOWANCE-0.5
;************************************************
N2620   RASTOCHKA_2:
;************************************************
N2630 DIAMOF
N2640 G97 M3 S=180
N2650 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=120+GLOBAL_ALLOWANCE+15

N2660 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=120+GLOBAL_ALLOWANCE+5 F=1 M8 M23
N2670  Z=-60-1.5 F=0.8
N2680  Z=-60-10 F=1.2

N2690  X=BORE_DIAM-GLOBAL_ALLOWANCE+2.50-0.2 F=1.2
N2700 G4S3

N2710 G0 G40 X=IC(-8) M9
N2720    Z=120+GLOBAL_ALLOWANCE+5
;N1990    X=BORE_DIAM-GLOBAL_ALLOWANCE+1.25

;N2000 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE+1.25 Z=120+GLOBAL_ALLOWANCE+5 F=1
;N2010  X=BORE_DIAM-GLOBAL_ALLOWANCE Z=120+GLOBAL_ALLOWANCE-1.25+5 F=0.5
;N2020 G4S5

N2730 G97 M3 S=20
;************************************************
;GO TO HOME POSITION
;************************************************
N2740 G0 G40 Z=IC(50) M5 M9
N2750 SUPA D0 X=1000 Z=800
N2760 G97 M3 S=20
N2770  M41 M5
;N2410     G4 F3
N2780  SPOS=236
N2790       M5
N2800      G4 F3
N2810  M52
N2820 T125
N2830 M6
N2840 D1
N2850 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N2860 M2
