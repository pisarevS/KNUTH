;************************************************
;KNUT MFD
;Wheel: KP0040-16
;last change: 15.02.2018
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0040_16P_MA4_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N120 DIAMOF
N121 S=50
N130 G0 G40 G54 X=394.5-10 Z=WHEEL_HEIGHT+15
;******************
;OBOD+GREBENJ
;******************
N140  G97 M3 S=50
N160 OFFN=GLOBAL_ALLOWANCE
N170 G1 G42 X=394.5-7 Z=WHEEL_HEIGHT F=1 M8 
N180   X=394.5+40 Z=WHEEL_HEIGHT F=1.6
N190   X=TREAD_DIAM+9.519 Z=WHEEL_HEIGHT  
N200 G3 X=TREAD_DIAM+25.149 Z=TREAD_HEIGHT_S1+62.766 CR=20.5 F=1.6
N210    X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.75 CR=12
N220 G1 X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.5
N225 M5
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N230 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N240  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N250 G96 M3 M42 S=160 LIMS=160
N260 G0 G40 X=394.5-10 
;************************************************
;OT YABLOKA
;************************************************
N270 OFFN=GLOBAL_ALLOWANCE
N280 G1 G41 X=394.5+0.424+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1 M8
N290  X=394.5-0.078+YABLOKO_VNUT Z=WHEEL_HEIGHT-0.29
N300  X=386.807+YABLOKO_VNUT Z=WHEEL_HEIGHT-28.709 F=1.5
N310 G3 X=368.988+YABLOKO_VNUT Z=WHEEL_HEIGHT-50.785+DISK_VNUT CR=35 F=2
N320   X=336.908 Z=WHEEL_HEIGHT-66.777+DISK_VNUT CR=1500
N330 G2 X=312.205 Z=WHEEL_HEIGHT-85.841+DISK_VNUT CR=76 
N340 G3 X=270 Z=WHEEL_HEIGHT-105.3+DISK_VNUT CR=55.5 
N350   X=260.054 Z=WHEEL_HEIGHT-104.402+0.2 CR=55.5
N360 G4 S1 

N370 G0 G40 G603 G641 Z=WHEEL_HEIGHT+60+150 M9
N380 G97 M3 M42 S=150 LIMS=150
;************************
;TORCOVKA STUPICY
;************************
N390 G60 X=130.5+20 Z=WHEEL_HEIGHT+60+VYLET_ST+8

N400 OFFN=GLOBAL_ALLOWANCE
N410 G97 M3 S=150 LIMS=150
N420 G1 G41 X=130.5+5 Z=WHEEL_HEIGHT+60+VYLET_ST F=1 M8 
N421 X=BORE_DIAM+30 F=0.8
N430  X=BORE_DIAM-15 Z=WHEEL_HEIGHT+60+VYLET_ST F=0.5

N440 G0 G40 Z=WHEEL_HEIGHT+60+100
N450 G0 G40 X=130.5+10 M9
N460   Z=WHEEL_HEIGHT+60+10
N470 G96 M3 S=150 LIMS=150
;************************************************
;OT STUPICY #1
;************************************************
;N480 OFFN=5+GLOBAL_ALLOWANCE
;N490 G1 G42 X=130.5 Z=WHEEL_HEIGHT+60 F=1.0 M8
;N500    X=142.777 Z=WHEEL_HEIGHT-17.511 F=1.0
;N510 G2 X=169.458 Z=WHEEL_HEIGHT-51.817 CR=45 F=1.3
;N520 G3 X=201.632 Z=WHEEL_HEIGHT-66.090 CR=1500 F=1.2
;N530   X=227.795 Z=WHEEL_HEIGHT-85.841 CR=76
;N540  G2 X=260.054 Z=WHEEL_HEIGHT-104.402 CR=55.5

N550  G0 G40 Z=WHEEL_HEIGHT+60+5+GLOBAL_ALLOWANCE
N560      X=130.5+10 M9
;************************************************
N570 OT_STUPICY_2:
;************************************************
N580 G96 M3 S=150 LIMS=150
N590 OFFN=GLOBAL_ALLOWANCE
N600 G1 G42 X=130.5-0.3+STUPICA_VNUT Z=WHEEL_HEIGHT+60 F=1.0 M8
N610   X=130.5+0.057+STUPICA_VNUT Z=WHEEL_HEIGHT+60-0.356
N620   X=142.777+STUPICA_VNUT Z=WHEEL_HEIGHT-17.511 F=1.6
N630 G2 X=169.458+STUPICA_VNUT Z=WHEEL_HEIGHT-51.817+DISK_VNUT CR=45 
N640 G3 X=201.632 Z=WHEEL_HEIGHT-66.090+DISK_VNUT CR=1500 F=2
N650    X=227.795 Z=WHEEL_HEIGHT-85.841+DISK_VNUT CR=76
N660 G2 X=260.054 Z=WHEEL_HEIGHT-104.402+DISK_VNUT CR=55.5 
N670    X=270 Z=WHEEL_HEIGHT-105.3+DISK_VNUT+0.07 CR=55.5
;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N680 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N690  G153 D0 Z=700
N700 S=50
N710  G153 G60 X=1150 Z=1000 M60 M9
N720 T2
N730 M6
N740 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N750 G0 G40 X=TREAD_DIAM+28+5 Z=TREAD_HEIGHT_S1+59.5+5

N760 G97 M3  S=50
N770 OFFN=GLOBAL_ALLOWANCE
N780 G1 G42 X=TREAD_DIAM+28 Z=TREAD_HEIGHT_S1+54.75+3 F=1.5 M8
N790 G1 X=TREAD_DIAM+28.0 Z=TREAD_HEIGHT_S1+54.5
N800 G3 X=TREAD_DIAM+26.748 Z=TREAD_HEIGHT_S1+49.163 CR=12
N810    X=TREAD_DIAM+15.675 Z=TREAD_HEIGHT_S1+39.265 CR=20 
N820 G1 X=TREAD_DIAM+12.001 Z=TREAD_HEIGHT_S1+37.927 
N830 G2   X=TREAD_DIAM+6.867 Z=TREAD_HEIGHT_S1+34.5 CR=17 F=1.1
N840 G1   X=TREAD_DIAM+4.114+0.5 Z=TREAD_HEIGHT_S1+30.0-0.5
N850 G1   X=TREAD_DIAM+3.576 Z=TREAD_HEIGHT_S1+28.5
N860    X=TREAD_DIAM+3.129 Z=TREAD_HEIGHT_S1+27.0
N870    X=TREAD_DIAM+2.741 Z=TREAD_HEIGHT_S1+25.5
N880    X=TREAD_DIAM+2.401 Z=TREAD_HEIGHT_S1+24.0
N890    X=TREAD_DIAM+2.101 Z=TREAD_HEIGHT_S1+22.5
N900 G1  X=TREAD_DIAM+1.834 Z=TREAD_HEIGHT_S1+21.0
N910 G1  X=TREAD_DIAM+1.597 Z=TREAD_HEIGHT_S1+19.5
N920    X=TREAD_DIAM+1.384 Z=TREAD_HEIGHT_S1+18.0
N930    X=TREAD_DIAM+1.193 Z=TREAD_HEIGHT_S1+16.5 M9
N940 G4 S1

N950 
N960 M5
;************************************************
;GO TO HOME POSITION
;************************************************
N970 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N980  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N990  G153 D0 Z=800  
N1000  G60 G153 X=1000 M9
;************************************************
;MACHINING FINISHED
;************************************************
N1010 M5 
N1020 SPOS=49
N1030    M5
N1040 G4F3
N1050 M52 

N1060 M56
;*********************
;*POSICITION N/S*
;*********************
N1080 M0

N1090 M51
N1100 
N1110 SPOS=30
N1120 M5
N1130 G4F3
N1140 M52

N1160 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1170 G18 G90 G95 F=1.2

N1180  N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1190 M51 
N1200    M56

N1210 T2
N1220 M6
N1230 DIAMOF

;CALL ZERO POINT SHIFT
N1240 G55
N1250 DIAMOF
N1260  G97 M41 M3 S=10
N1270 M0
N1280  G97 M41 M3 S=35
N1290 G0 G40 X=TREAD_DIAM+5 Z=WHEEL_HEIGHT+5
N1360  G97 M3 S=60 LIMS=60
;************************************************
;CHERNOVOY_PO_KRUGU_KATANIYA
;************************************************
N1370 OFFN=GLOBAL_ALLOWANCE
N1380 G1 G42 X=TREAD_DIAM-3.644+1-10 Z=WHEEL_HEIGHT+10 F=1.3 M8
N2670    X=TREAD_DIAM-2.644+1 Z=WHEEL_HEIGHT-1
N2680    X=TREAD_DIAM-0.780 Z=TREAD_HEIGHT_S2+32.158+5 F=1.5
N1400  X=TREAD_DIAM Z=TREAD_HEIGHT_S2+5 F=1.8
N1410  X=TREAD_DIAM+0.035 Z=TREAD_HEIGHT_S2-0.5+5
N1420  X=TREAD_DIAM+0.054 Z=TREAD_HEIGHT_S2-1.0+5
N1430  X=TREAD_DIAM+0.074 Z=TREAD_HEIGHT_S2-1.5+5
N1440  X=TREAD_DIAM+0.094 Z=TREAD_HEIGHT_S2-2.0+5
N1450  X=TREAD_DIAM+0.116 Z=TREAD_HEIGHT_S2-2.5+5
N1460  X=TREAD_DIAM+0.138 Z=TREAD_HEIGHT_S2-3.0+5
N1470  X=TREAD_DIAM+0.161 Z=TREAD_HEIGHT_S2-3.5+5
N1480  X=TREAD_DIAM+0.185 Z=TREAD_HEIGHT_S2-4.0+5
N1490  X=TREAD_DIAM+0.211 Z=TREAD_HEIGHT_S2-4.5+5
N1500  X=TREAD_DIAM+0.237 Z=TREAD_HEIGHT_S2-5.0+5
N1510  X=TREAD_DIAM+0.264 Z=TREAD_HEIGHT_S2-5.5+5
N1520  X=TREAD_DIAM+0.292 Z=TREAD_HEIGHT_S2-6.0+5
N1530  X=TREAD_DIAM+0.322 Z=TREAD_HEIGHT_S2-6.5+5
N1540  X=TREAD_DIAM+0.352 Z=TREAD_HEIGHT_S2-7.0+5
N1550  X=TREAD_DIAM+0.384 Z=TREAD_HEIGHT_S2-7.5+5
N1560  X=TREAD_DIAM+0.417 Z=TREAD_HEIGHT_S2-8.0+5
N1570  X=TREAD_DIAM+0.451 Z=TREAD_HEIGHT_S2-8.5+5
N1580  X=TREAD_DIAM+0.486 Z=TREAD_HEIGHT_S2-9.0+5
N1590  X=TREAD_DIAM+0.523 Z=TREAD_HEIGHT_S2-9.5+5
N1600  X=TREAD_DIAM+0.561 Z=TREAD_HEIGHT_S2-10.0+5
N1610  X=TREAD_DIAM+0.600 Z=TREAD_HEIGHT_S2-10.5+5
N1620  X=TREAD_DIAM+0.640 Z=TREAD_HEIGHT_S2-11.0+5
N1630  X=TREAD_DIAM+0.682 Z=TREAD_HEIGHT_S2-11.5+5
N1640  X=TREAD_DIAM+0.726 Z=TREAD_HEIGHT_S2-12.0+5
N1650  X=TREAD_DIAM+0.771 Z=TREAD_HEIGHT_S2-12.5+5
N1660  X=TREAD_DIAM+0.818 Z=TREAD_HEIGHT_S2-13.0+5
N1670  X=TREAD_DIAM+0.866 Z=TREAD_HEIGHT_S2-13.5+5
N1680  X=TREAD_DIAM+0.916 Z=TREAD_HEIGHT_S2-14.0+5
N1690  X=TREAD_DIAM+0.967 Z=TREAD_HEIGHT_S2-14.5+5
N1700  X=TREAD_DIAM+1.021 Z=TREAD_HEIGHT_S2-15.0+5
N1710  X=TREAD_DIAM+1.076 Z=TREAD_HEIGHT_S2-15.5+5
N1720  X=TREAD_DIAM+1.134 Z=TREAD_HEIGHT_S2-16.0+5
N1730  X=TREAD_DIAM+1.193 Z=TREAD_HEIGHT_S2-16.5+5
N1740  X=TREAD_DIAM+1.254 Z=TREAD_HEIGHT_S2-17.0+5
N1750  X=TREAD_DIAM+1.318 Z=TREAD_HEIGHT_S2-17.5+5
N1760  X=TREAD_DIAM+1.384 Z=TREAD_HEIGHT_S2-18.0+5
N1770  X=TREAD_DIAM+1.452 Z=TREAD_HEIGHT_S2-18.5+5
N1780  X=TREAD_DIAM+1.523 Z=TREAD_HEIGHT_S2-19.0+5
N1790  X=TREAD_DIAM+1.597 Z=TREAD_HEIGHT_S2-19.5+5
N1800  X=TREAD_DIAM+1.673 Z=TREAD_HEIGHT_S2-20.0+5
N1810  X=TREAD_DIAM+1.752 Z=TREAD_HEIGHT_S2-20.5+5
N1820  X=TREAD_DIAM+1.834 Z=TREAD_HEIGHT_S2-21.0+5
N1830  X=TREAD_DIAM+1.920 Z=TREAD_HEIGHT_S2-21.5+5
N1840  X=TREAD_DIAM+2.008 Z=TREAD_HEIGHT_S2-22.0+5
N1850  X=TREAD_DIAM+2.101 Z=TREAD_HEIGHT_S2-22.5+5
N1860  X=TREAD_DIAM+2.197 Z=TREAD_HEIGHT_S2-23.0+5
N1870  X=TREAD_DIAM+2.297 Z=TREAD_HEIGHT_S2-23.5+5
N1880 G4 S1

N1890 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1900  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+50
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T125
;************************************************
N1910 G153 D0 Z=800  M9
N1920 G60 G153 X=1150 Z=1000 M60
N1930 T125
N1940 M6
N1950 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1960 G96 M3 S=150 LIMS=150
N1970 G0 G40  X=394.5-$P_TOOLR Z=WHEEL_HEIGHT+8

N1980 OFFN=5+GLOBAL_ALLOWANCE
N1990 G1 G41 X=394.5 Z=WHEEL_HEIGHT F=1.25 M8
N2000    X=394.5 Z=112.336+5 F=1.4
N2010 G3 X=364.5 Z=82.336+5+2 CR=30 F=1.2
N2020 G4S1

N2030 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N2040 G0 G40  X=394.5-$P_TOOLR Z=WHEEL_HEIGHT+8 M9
;************************************************
N2050  OT_YABLOKA_2:
;************************************************
N2060 OFFN=GLOBAL_ALLOWANCE
N2070 G1 G41 X=394.5+0.3+YABLOKO_NAR Z=WHEEL_HEIGHT F=1.2 M8
N2080    X=394.5+YABLOKO_NAR Z=WHEEL_HEIGHT-0.3
N2090    X=394.5+YABLOKO_NAR Z=112.336+DISK_NAR+5 F=1.4
N2100 G3 X=364.5+YABLOKO_NAR Z=82.336+DISK_NAR+5 CR=30 F=1.2
N2110   X=352.725 Z=84.109+DISK_NAR+0.2+5 CR=40
N2120 G4S1

N2130 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200

N2200    X=212.175-10
N2210    G60 Z=126.3+DISK_NAR+GLOBAL_ALLOWANCE+5
;************************************************
;K YABLOKU
;************************************************
N2220 OFFN=GLOBAL_ALLOWANCE
N2230 G1 G42 X=270.000 Z=126.3+DISK_NAR+5 F=1.4
N2240 G3 X=327.280 Z=100.508+DISK_NAR+5 CR=76.5 
N2250 G2 X=352.724 Z=84.109+DISK_NAR+5 CR=56 
N2260    X=364.5+YABLOKO_NAR Z=82.336+DISK_NAR+0.3+5 CR=40
;************************************************
;PATH CONTROL MODE TO BOTTOM #3 OUTSIDE-INSIDE
;************************************************
N2270 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2280    Z=126.3+GLOBAL_ALLOWANCE+200
N2290    G60 X=270.0+6 Z=126.3+DISK_NAR+GLOBAL_ALLOWANCE+0.5+5
;************************************************
;PO DISKU K STUPICE
;************************************************
N2300 G96 M42 M3 S150 LIMS=150
N2310 OFFN=GLOBAL_ALLOWANCE
N2320 G1 G41 X=270.0+4 Z=126.3+0.2+DISK_NAR+5 F=1.8
N2330 G1 X=270.0 Z=126.3+0.05+DISK_NAR+5 F=1.5
N2340 G2 X=212.175 Z=99.886+DISK_NAR+5 CR=76.5 F=1
N2350 G3 X=170.177 Z=80.551+DISK_NAR+0.02+5 CR=56 F=1.3

N2360 G0 G40 Z=WHEEL_HEIGHT+200

N2370 G96 M3 S=150 LIMS=150 M9
N2380 G60 X=134+25 Z=120+30 
;************************************************
N2390 OFFN=5+GLOBAL_ALLOWANCE
N2400 G1 G41 X=134+10 Z=120+10 F=1 M8
N2410  X=BORE_DIAM-12 Z=120+10 F=1

N2420 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(9+GLOBAL_ALLOWANCE)
N2430  X=134+25 M9
N2440  Z=120+15 
; ***********************************************
N2450 TORCOVKA_STUPICY_2:
;***********************************************
N2460 OFFN=GLOBAL_ALLOWANCE
N2470 G1 G41 X=134+10 Z=120+10 F=0.8 M8
N2480  X=BORE_DIAM-17 Z=120+10 F=1

N2490 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3+GLOBAL_ALLOWANCE)

;N2500  X= 134+10 M9
N2510 G97 M3  S=150 LIMS=150
;************************************************
;OT STUPICY_1
;************************************************
;N2520 OFFN=5+GLOBAL_ALLOWANCE
;N2530 G1 G42 X=134.0 Z=120+10 F=1.0 M8
;N2540    X=142.103 Z=99.515+5 F=1.2
;N2550 G2 X=170.177 Z=80.551+5 CR=30 F=1.4

;N2560 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N2570 G0 G40  X=134+10 Z=120+17 M9
;************************************************
N2580   OT_STUPICY_2:
;************************************************
N2590 OFFN=GLOBAL_ALLOWANCE
N2600 G1 G42 X=134-0.3+STUPICA_NAR Z=120+10 F=1.3 M8
N2610    X=134+0.196+STUPICA_NAR Z=120-0.496+10 F=1.0
N2620    X=142.103+STUPICA_NAR Z=99.515+5 F=1.4
N2630 G2 X=170.177+STUPICA_NAR Z=80.551+DISK_NAR+5 CR=30 F=1.4
N2640 G2 X=184.973 Z=82.631+DISK_NAR+0.05+5 CR=56 F=1.4
;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2650 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2660  G153 D0 Z=700
N2670  G60 G153 X=1150 Z=1000 M60 M9
N2680 G97 M3 S=170
N2690 T5 D1
N2700 M6
N2710 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
;N840  M42
N2720 M3 G97 S=180 LIMS=220
;************************************************
;RASTOCHKA, 1 CUT
;************************************************
N2730 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=120+GLOBAL_ALLOWANCE+15

N2740 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=120+GLOBAL_ALLOWANCE+5 F=1 M8
N2750  Z=-60-1.5 F=1
N2760  Z=-60-10 F=1.2

N2770 G0 G40 X=IC(-8) M9
N2780    Z=120+GLOBAL_ALLOWANCE+10+5
N2790    X=BORE_DIAM-GLOBAL_ALLOWANCE-0.5
;************************************************
N2800   RASTOCHKA_2:
;************************************************
N2810 DIAMOF
N2820 G97 M3 S=180
N2830 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=120+GLOBAL_ALLOWANCE+15

N2840 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=120+GLOBAL_ALLOWANCE+5 F=1 M8
N2850  Z=-60-1.5 F=1
N2860  Z=-60-10 F=1.2 M23

N2870  X=BORE_DIAM-GLOBAL_ALLOWANCE+2.50-0.2 F=1.2
N2880 G4S2
N2885 M5
N2890 G0 G40 X=IC(-8) M9
N2900    Z=120+GLOBAL_ALLOWANCE+5
;************************************************
;GO TO HOME POSITION
;************************************************
N2920 G0 G40 Z=IC(50)
N2930 SUPA D0 X=1000 Z=800
N2950  M41 M5
;N2410     G4 F3
N2960  SPOS=30
N2970       M5
N2980      G4 F3
N2990  M52
N3000 T125
N3010 M6
N3020 D1
N3030 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N3040 M2
