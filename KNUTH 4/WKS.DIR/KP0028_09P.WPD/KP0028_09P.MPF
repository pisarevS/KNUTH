;************************************************
;KNUT MFD
;Wheel: KP0028-09
;last change: 14.02.2018
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0028_09P_MA4_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N110 G97 M41 M3 S35
N120 DIAMOF
N130 G0 G40 G54 X=368.5-10 Z=WHEEL_HEIGHT+10
;******************
;OBOD+GREBENJ
;******************
N140  G96 M3 S=110
N150  LIMS=40
N160 OFFN=GLOBAL_ALLOWANCE
N170 G1 G42 X=368.5-7 Z=WHEEL_HEIGHT F=1 M8 
N180   X=368.5+40 Z=WHEEL_HEIGHT F=1.5
N190    X=TREAD_DIAM+13.500 Z=WHEEL_HEIGHT F=1.2 LIMS=32
N540    X=TREAD_DIAM+21.405     Z=WHEEL_HEIGHT-1.111 F=1.0
N550 G3 X=TREAD_DIAM+30.00      Z=TREAD_HEIGHT_S1+59.5 CR=10 F=0.8
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N320 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N330  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N340 G96 M3 S=115 LIMS=55
N350 G0 G40 X=368.5-10 M9
;************************************************
;OT YABLOKA
;************************************************
N270 OFFN=GLOBAL_ALLOWANCE
N510 G1 G41 X=368.5+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1.2 M8
N530 G1 X=362.182+YABLOKO_VNUT Z=WHEEL_HEIGHT-22.032 F=1.3
N550 G3 X=314.119+YABLOKO_VNUT Z=WHEEL_HEIGHT-58.25+DISK_VNUT CR=50 F=1.3
N560 X=311.345+YABLOKO_VNUT Z=WHEEL_HEIGHT-58.25+DISK_VNUT CR=5000
N570 G2 X=279.059 Z=WHEEL_HEIGHT-65.295+DISK_VNUT CR=77.5
N580 G3 X=256.209 Z=WHEEL_HEIGHT-69.984+DISK_VNUT CR=51.75
N410 G4 S1 

N420 G0 G40 G603 G641 Z=WHEEL_HEIGHT+15.5+150 M9
N430 G97 M3 M42 S=110 LIMS=120
;************************
;TORCOVKA STUPICY
;************************
N510 G60 X=130+15 Z=WHEEL_HEIGHT+15.5+5

N520 OFFN=GLOBAL_ALLOWANCE
N530 G97 M3 S=120 LIMS=140
N540 G1 G41 X=130+5 Z=WHEEL_HEIGHT+15.5 F=1 M8 
N550  X=BORE_DIAM-15 Z=WHEEL_HEIGHT+15.5 F=1.1

N560 G0 G40 Z=WHEEL_HEIGHT+15.5+100
N570 G0 G40 X=130+10 M9
N575   Z=WHEEL_HEIGHT+15.5+10
N580 G96 M3 S=115 LIMS=140
;************************************************
;OT STUPICY #1
;************************************************
N590 OFFN=5+GLOBAL_ALLOWANCE
N690 G1 G42 X=130 Z=WHEEL_HEIGHT+15.5 F=1.0 M8
N700  X=137.825 Z=WHEEL_HEIGHT-11.788 F=1.2
N720 G2 X=195.5 Z=WHEEL_HEIGHT-55.25 CR=60 F=1.3
N730  X=197.171 Z=WHEEL_HEIGHT-55.25 CR=5000
N740 G3 X=233.622 Z=WHEEL_HEIGHT-64.162 CR=79
N750 G2 X=244.584 Z=WHEEL_HEIGHT-68.362 CR=51.75

N650  G0 G40 Z=WHEEL_HEIGHT+15.5+5+GLOBAL_ALLOWANCE
N660      X=130+10 M9
;************************************************
 OT_STUPICY_2:
;************************************************
N580 G96 M3 S=140 LIMS=140
N670 OFFN=GLOBAL_ALLOWANCE
N860 G1 G42 X=130+STUPICA_VNUT Z=WHEEL_HEIGHT+15.5+VYLET_ST F=1.3 M8
N890   X=137.825+STUPICA_VNUT Z=WHEEL_HEIGHT-11.788 F=1.2
N910 G2 X=195.5 Z=WHEEL_HEIGHT-55.25+DISK_VNUT CR=60 F=1.3
N920  X=197.171 Z=WHEEL_HEIGHT-55.25+DISK_VNUT CR=5000
N930 G3 X=233.622 Z=WHEEL_HEIGHT-64.162+DISK_VNUT CR=79
N940 G2 X=279.059 Z=WHEEL_HEIGHT-65.295+0.17+DISK_VNUT CR=51.75
;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N740 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N750  G153 D0 Z=700
M5
N760  G153 G60 X=1000 M60 M9
N780 T20
N790 M6
N800 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N810 G0 G40 X=TREAD_DIAM+30+5 Z=TREAD_HEIGHT_S1+59.5+5

N820 G97 M3 M41 S=35
N830 OFFN=GLOBAL_ALLOWANCE
N830 G1 G42 X=TREAD_DIAM+30 Z=TREAD_HEIGHT_S1+59.5+3 F=1.5 M8
N840 G1 X=TREAD_DIAM+30 Z=TREAD_HEIGHT_S1+59.5 F=1.1
N880 G3 X=TREAD_DIAM+18.77 Z=TREAD_HEIGHT_S1+43.805 CR=18.000
N890 G1 X=TREAD_DIAM+11.96 Z=TREAD_HEIGHT_S1+41.053
N900 G2 X=TREAD_DIAM+4.273 Z=TREAD_HEIGHT_S1+32.362 CR=13 F=1.3
N910 G2 X=TREAD_DIAM+1.486 Z=TREAD_HEIGHT_S1+17.57 CR=100 F=1
N900 G4 S1

N1080 M23 
N1090 G97 M3 S=85 LIMS=85 
;************************************************
;GO TO HOME POSITION
;************************************************
N1100 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N1110  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N1120  G153 D0 Z=800  
N1130  G60 G153 X=1000 M9
;************************************************
;MACHINING FINISHED
;************************************************
N1150 G4 F5
N1170 SPOS=303
N1180    M5
N1190 G4F3
N1200 M52 

N1210 M56
N1220 MSG("OBRABOTKA V/S ZAVERSHENA")
;*********************
;*POSICITION N/S*
;*********************
N1230 M0

N1240 M51
N1250 G97 M41 M3 S5
N1260 SPOS=42
N1270 M5
N1280 G4F3
N1290 M52

N1300 MSG("ZAGRUZKA N/S")
N1310 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1320 G18 G90 G95 F=1.2

N1330  N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1340 M51 
N1350    M56

N1360 T20
N1370 M6
N1380 DIAMOF

;CALL ZERO POINT SHIFT
N1390 G55
N1400 DIAMOF
N1410  G97 M41 M3 S=10
N1420 M0
N1430  G97 M41 M3 S=35
N1440 G0 G40 X=TREAD_DIAM+5 Z=WHEEL_HEIGHT+5

N1450  G95 LIMS=30
;************************************************
;TORCOVKA OBODA
;************************************************
N1460 OFFN=GLOBAL_ALLOWANCE
N1470 G1 G41 X=TREAD_DIAM Z=WHEEL_HEIGHT F=1.1  M8
N1480 X=368.5-15 Z=WHEEL_HEIGHT  F=1.4

N1490 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(2.0+GLOBAL_ALLOWANCE)
N1500 X=TREAD_DIAM+10
N1510  G97 M3 S=35 LIMS=32
;************************************************
;CHERNOVOY_PO_KRUGU_KATANIYA
;************************************************
N1520 OFFN=GLOBAL_ALLOWANCE
N420 G1 G42 X=TREAD_DIAM-1.547 Z=WHEEL_HEIGHT F=0.9 M8
N430 X=TREAD_DIAM-0.547 Z=WHEEL_HEIGHT-1
N450 X=TREAD_DIAM-0.547 Z=TREAD_HEIGHT_S2+19+5 F=1.1 
N470 G2 X=TREAD_DIAM+1.488 Z=TREAD_HEIGHT_S2-17.574+5 CR=330 
N480 X=TREAD_DIAM+4.273+0.1 Z=TREAD_HEIGHT_S2-32.362+5 CR=100
N490 G1 X=TREAD_DIAM+9.00 Z=TREAD_HEIGHT_S2-33.865+5
N1610 G4 S1

N1610 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1620  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+50
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T125
;************************************************
N1120 G153 D0 Z=800  M9
N1130 G60 G153 X=1000
N1880 T125
N1890 M6
N1900 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1910 G96 M3 S=100 LIMS=85
N1920 G0 G40  X=368.5-$P_TOOLR Z=WHEEL_HEIGHT+8

N1930 OFFN=5+GLOBAL_ALLOWANCE
N320 G1 G41 X=368.5 Z=WHEEL_HEIGHT F=0.8 M7 M8
N330  X=362.296 Z=114.0+5 F=1.1
N340 G3 X=315.553 Z=81.75+5 CR=50
;N350  X=291.917 Z=88.524+5 CR=52.56
;N360 G2 X=224.901 Z=89.386+5 CR=78.25
;N370 G3 X=203.655 Z=84.75+5 CR=51
N2020 G4S1

N2030 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N2050 G0 G40  X=368.5-$P_TOOLR Z=WHEEL_HEIGHT+8 M9
;************************************************
  OT_YABLOKA_2:
;************************************************
N2060 OFFN=GLOBAL_ALLOWANCE
N430 G1 G41 X=368.5+YABLOKO_NAR Z=WHEEL_HEIGHT F=0.9 M8
N440  X=362.296+YABLOKO_NAR Z=114+5 F=1.3
N450 G3 X=315.553+YABLOKO_NAR Z=81.75+DISK_NAR+5 CR=50
;N460  X=291.917 Z=88.524+DISK_NAR+5 CR=52.56
;N470 G2 X=224.901 Z=89.386+DISK_NAR+5 CR=78.25
;N480 G3 X=203.655 Z=84.75+DISK_NAR+5 CR=51
N2150 G4S1

N2160 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
;************************************************
;MOVE TO OUTER BOTTOM #2
;************************************************
N2170 G96 M3 M42 S=110 LIMS=140
N2180 G60 X=130+12 Z=156+10
;************************************************
;TORCOVKA STUPICY
;************************************************
N2190 OFFN=4+GLOBAL_ALLOWANCE
N2200 G1 G41 X=130+10 Z=156+5 F=1 M8
N2210  X=BORE_DIAM-12 Z=156+5 F=1

N2220 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(8+GLOBAL_ALLOWANCE)
N2230  X=130+12
N2240  Z=156+10
; ***********************************************
 TORCOVKA_STUPICY_2:
;***********************************************
N2250 OFFN=GLOBAL_ALLOWANCE
N2260 G1 G41 X=130+10 Z=156+5 F=0.8 M8
N2270  X=BORE_DIAM-17 Z=156+5 F=1

N2280 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3+GLOBAL_ALLOWANCE)

N2290  X= 130+10
N2300 G96 M3  S=140 LIMS=140
;************************************************
;OT STUPICY_1
;************************************************
N2310 OFFN=5+GLOBAL_ALLOWANCE
N580 G1 G42 X=130 Z=156+5 F=1.0
N590  X=137.968 Z=128.211+5 F=1.3
N600 G2 X=195.643 Z=84.75+5 CR=60 F=1.3
N610  X=203.654 Z=84.75+5 CR=5000
N610  X=224.901 Z=89.386+5 CR=51
N610 G3 X=291.917 Z=88.525+5 CR=78.25
N610 G2 X=315.553 Z=81.75+5 CR=52.56

N2030 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200
N2050 G0 G40  X=130+10 Z=156+12 M9
;************************************************
   OT_STUPICY_2:
;************************************************
N2310 OFFN=GLOBAL_ALLOWANCE
N710 G1 G42 X=130+STUPICA_NAR Z=156+5 F=1 M8
N740 G1 X=137.968+STUPICA_NAR Z=128.212+5 F=1.2
N760 G2 X=195.644+STUPICA_NAR Z=84.75+DISK_NAR+5 CR=60 F=1.2
N770  X=203.654 Z=84.75+DISK_NAR+5 CR=5000
N780  X=224.901 Z=89.386+DISK_NAR+5 CR=51 F=1.3
N610 G3 X=291.917 Z=88.525+DISK_NAR+5 CR=78.25
N610 G2 X=315.553 Z=81.75+DISK_NAR+5 CR=52.56
N610  X=325.487 Z=82.747+DISK_NAR+0.15+5 CR=50
;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2370 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2380  G153 D0 Z=700
N2390  G60 G153 X=1000 M9
N2400 G97 M3 S=170
N2410 T5 D1
N2420 M6
N2430 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
;N840  M42
N2440 M3 G97 S=165 LIMS=220
;************************************************
;RASTOCHKA, 1 CUT
;************************************************
N1670 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-8 Z=156+GLOBAL_ALLOWANCE+15

N1690 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-8 Z=156+GLOBAL_ALLOWANCE+5 F=1 M8
N1730  Z=-15.5-1.5 F=0.8
N1740  Z=-15.5-10 F=1.2

N1760 G0 G40 X=IC(-8) M9
N1770    Z=156+GLOBAL_ALLOWANCE+10+5
N1780    X=BORE_DIAM-GLOBAL_ALLOWANCE-0.5
;************************************************
   RASTOCHKA_2:
;************************************************
N1790 DIAMOF
N1850 G97 M3 S=180
N1860 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=156+GLOBAL_ALLOWANCE+15

N1880 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=156+GLOBAL_ALLOWANCE+5 F=1 M8
N1920  Z=-15.5-1.5 F=0.8
N1930  Z=-15.5-10 F=1.2

N1950  X=BORE_DIAM-GLOBAL_ALLOWANCE+2.50-0.2 F=1.2
N1960 G4S2

N1970 G0 G40 X=IC(-8) M9
N1980    Z=156+GLOBAL_ALLOWANCE+5
;N1990    X=BORE_DIAM-GLOBAL_ALLOWANCE+1.25

;N2000 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE+1.25 Z=156+GLOBAL_ALLOWANCE F=1
;N2010  X=BORE_DIAM-GLOBAL_ALLOWANCE Z=156+GLOBAL_ALLOWANCE-1.25 F=0.5
;N2020 G4S5

N2770 G97 M3 S=20
;************************************************
;GO TO HOME POSITION
;************************************************
N2780 G0 G40 Z=IC(50)
N2790 SUPA D0 X=1000 Z=800
N2800 G97 M3 S=20
N2810  M41
;N2410     G4 F3
N2820  SPOS=42
N2830       M5
N2840      G4 F3
N2850  M52
N2860 T125
N2870 M6
N2880 D1
N2890 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N2900 M2
