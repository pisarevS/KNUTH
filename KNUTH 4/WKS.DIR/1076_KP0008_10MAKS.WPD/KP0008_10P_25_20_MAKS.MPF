
;************************************************
;KNUT MFD
;Wheel: KP-0008-10 MAVRITANIYA 1076
;last change: 11.03.2016 by DIS
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0008_10P_MA4_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N110 G97 M41 M3 S55
N120 DIAMOF
N130 G0 G40 G54 X=TREAD_DIAM+29+8 Z=WHEEL_HEIGHT+5
;****************
;OBOD
;****************
N140  G95 M3 S=29
N150  LIMS=30
N160 OFFN=0.4
N170 G1 G41 X=TREAD_DIAM+29+3 Z=WHEEL_HEIGHT F=3 M8 
N180  X=444-5 Z=WHEEL_HEIGHT F=1.7

N190 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(1)
N200  X=TREAD_DIAM+29
;************************************************
;CHERNOVOY PO GREBNU, #1 CUT
;************************************************
N210 OFFN=0.5
N220 G1 G42 X=TREAD_DIAM+29 Z=WHEEL_HEIGHT F=2.5 S=30
N230  X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966+5 F=1.8
N240 G1 X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966-2 F=1.2
;  PATH CTRL MODE TO CUT#2
N250 G0 G40 G603 G641 ADISPOS=15
N260  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
N270 G60 X=TREAD_DIAM+18.202-$P_TOOLR-0.5-3.5 Z=WHEEL_HEIGHT+2
;************************************************
;CHERNOVOY PO GREBNU, #2 CUT
;************************************************
N280 OFFN=0.5
N290 G1 G42 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT F=2.2 M8 S=30
N300        X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.726 F=1.5
N310 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6   F=1.85
N320 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.939
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N330 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N340  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N350 G96 M3 S=113 LIMS=70 
N360 G0 G40 X=444-10 M9

     ;GOTOF YABL_2

N370 OFFN=GLOBAL_ALLOWANCE+3.8
N380 G1 G41 X=444.0 Z=WHEEL_HEIGHT F=1 M7 M8
N390 Z=WHEEL_HEIGHT-4.5 F=1.2
N400 G3 X=384.091 Z=WHEEL_HEIGHT-53.508 CR=50 F=1.15
N410 G1 X=330.0 Z=WHEEL_HEIGHT-42.572 F=1.4
N420 X=300.0 Z=WHEEL_HEIGHT-36.507+0.5 F=1.35
N430 G4S2


N440 G0 G40 G603 G641 Z=WHEEL_HEIGHT+180
N450 G60 X=446.3-16 Z=WHEEL_HEIGHT+10

N460     YABL_2:

;************************************************
; CHERNOVOY PROHOD ##### OT YABLOKA #2
;************************************************

N470 OFFN=GLOBAL_ALLOWANCE
N480 G1 G41 X=444.0+2.3+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1 M7 M8
N490 G1 X=444.0+YABLOKO_VNUT Z=WHEEL_HEIGHT-2.3 F=1
N500 G3 X=384.091 Z=WHEEL_HEIGHT-53.508+DISK_VNUT CR=50
N510 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT  
N520 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT+0.3


N530 G0 G40 G603 G641 Z=WHEEL_HEIGHT+80+150 
N540 G97 M3  S=120 LIMS=120
;************************
;TORCOVKA STUPICY
;************************
N550 G60 X=157.02+40 Z=WHEEL_HEIGHT+47.5

N560 OFFN=0
N570 G96 M3 S=180 LIMS=85
N580 OFFN=GLOBAL_ALLOWANCE
N590 G1 G41 X=157.02+10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.6 M8
N600 X=BORE_DIAM-10+5 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.6; F=0.8
N610 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(4)  M9

N620 G0 G40 X=157.02+10

N630 G96 M3 S=180 LIMS=86

 ;GOTOF STUP_2

;************************************************
;OT STUPICY 1
;************************************************

N640 OFFN=8+GLOBAL_ALLOWANCE
N650 G1 G42 X=157.02 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N660 X=167.160 Z=WHEEL_HEIGHT+19.64 F=0.7 ; F=1.1
N670 G2 X=211.652 Z=WHEEL_HEIGHT-18.646 CR=60  F=0.72 ;F=1.3
;N620 G1 X=330.0 Z=WHEEL_HEIGHT-42.572    ;;;;ZAKRIT' ETOT KADR ESLI PO DISKU MALO BERET

N680 G0 G40 G603 G641 Z=WHEEL_HEIGHT+47.5+VYLET_ST+250
N690 X=157.02+16 Z=WHEEL_HEIGHT+47.5+VYLET_ST+15

;************************************************
;CHERNOVOY OT STUPICY,## 2CUT
;************************************************

N700     STUP_2:

N710 LIMS=86

N720 OFFN=GLOBAL_ALLOWANCE
N730 G1 G42 X=157.02-0.3+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N740 X=157.02+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5-0.3 F=0.3
N750 X=167.160+STUPICA_VNUT+0.5 Z=WHEEL_HEIGHT+19.64 F=1
N760 G2 X=211.652 Z=WHEEL_HEIGHT-18.646+DISK_VNUT CR=60  F=0.85 ;F=1.1
;     G1 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT
N770 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT+0.1 F=1.0

;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N780 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N790  G153 D0 Z=700
N800  G153 G60 X=1000 M60 M9
N810 T2
N820 M6
N830 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N840 G0 G40 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651+5

N850 G97 M3 S=30
N860 G95 LIMS=RTOI(75/(2*3.14*(TREAD_DIAM+30)/1000))
N870    OFFN=0.6
N880 G1 G42 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651  F=1.3   M8
N890 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N900 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=0.6

N910 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 
N920 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N930     G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34
N940 G4 S1
N950 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N960  X=TREAD_DIAM+32 Z=TREAD_HEIGHT_S1+15.150
N970  Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO GREBNU
;************************************************
N980 G0 G40 X=444.0-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N990 G96 M3 M42 S=70
N1000 G95 LIMS=RTOI(120/(2*3.14*(TREAD_DIAM+30)/1000))
N1010 G0 Z=WHEEL_HEIGHT+10
N1020 G0 G60 Z=WHEEL_HEIGHT

N1030 OFFN=0
N1040 G1 G42 X=444.0 Z=WHEEL_HEIGHT F=2 M8 S=70
N1050 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT
N1060 X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.7695 F=1.75
N1070 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6
N1080 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N1090 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=0.95
N1100 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 
N1110 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N1120 G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34 M23 
N1130 G97  M3 S200 LIMS=200 M23
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N1140 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N1150  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N1160  G153 D0 Z=800
N1170  G60 G153 X=1000 
;************************************************
;MACHINING CH1 FINISHED, WAIT FOR FINISHING CH2
;************************************************
N1180 G4 F5
N1190 M9
N1200 SPOS=209
N1210    M5
N1220 G4F4
N1230 M52 

N1240 M56
N1250 MSG("OBRABOTKA V/S ZAVERSHENA")
;*********************
;*POSICITION N/S*
;*********************
N1260 M0

N1270 M51
N1280 G97 M41 M3 S5
N1290 SPOS=229
N1300 M5
N1310 G4F4
N1320 M52

N1330 MSG("ZAGRUZKA N/S")
N1340 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1350 G18 G90 G95 F=1.2

N1360   N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1370 M51 
N1380    M56

N1390 T2
N1400 M6
N1410 DIAMOF

;CALL ZERO POINT SHIFT
N1420 G55
N1430 DIAMOF
N1440  G97 M41 M3 S=10
N1450 M0
N1460 G97 M41 M3 S28
N1470 G0 G40 X=TREAD_DIAM+12 Z=WHEEL_HEIGHT


N1480  G95 LIMS=30
;************************************************
;TORCOVKA OBODA
;************************************************
N1490 OFFN=TREAD_ALLOWANCE
N1500 G1 G41 X=TREAD_DIAM Z=WHEEL_HEIGHT F=1.2  M8
N1510 X=444-15 Z=WHEEL_HEIGHT  F=1.6 S=31

N1520 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(2.0)
N1530 X=TREAD_DIAM
;************************************************
;CHERNOVOY PO KRUGU KATANIYA
;************************************************
N1540 OFFN=GLOBAL_ALLOWANCE+1.1
N1550 G1 G42 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1.2 M7 M8
N1560    X=TREAD_DIAM Z=WHEEL_HEIGHT-5
;N1560    X=TREAD_DIAM Z=TREAD_HEIGHT_S2
;N1570    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354
;N1580   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34
;N1590 G4 S1

N1570 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1580  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10
N1590 G60 X=TREAD_DIAM-10 Z=WHEEL_HEIGHT+50



;************************************************
;CHISTOVOY PO KRUGU KATANIYA
;************************************************
N1600 OFFN=GLOBAL_ALLOWANCE
N1610 G0 G40 X=440-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N1620 G97 M3 S=60
N1630 G95 LIMS=RTOI(165/(2*3.14*TREAD_DIAM/1000))

N1640 G0 Z=WHEEL_HEIGHT+10

N1650      G1 G42 X=444-5 Z=WHEEL_HEIGHT F=1
N1660 G1 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1.52 M7 M8
N1670    X=TREAD_DIAM-0.8 Z=WHEEL_HEIGHT-5 F=1.2
N1680    X=TREAD_DIAM Z=TREAD_HEIGHT_S2 F=0.95
N1690    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354 F=0.99
;N1700   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34 F=1.1


N1710 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1720  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10

;************************************************
;TOOL CHANGE T125
;************************************************
N1730 SUPA G0 G40 D0 X=1000 Z=700  OFFN=0 M9

N1740 T125
N1750 M6
N1760 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1770 G96 M3 S=115 
N1780 G0 G40  X=444-$P_TOOLR Z=WHEEL_HEIGHT+8

N1790 OFFN=6+GLOBAL_ALLOWANCE
N1800 G1 G41 X=447.77 Z=WHEEL_HEIGHT F=1.0  M8 
N1810 X=441.25 Z=119.000 F=1.08
N1820 G3 X=403.533 Z=90.126 CR=50 F=1.0
N1830 G1 X=289.069 Z=71.839 F=1.0
N1840 G4S1 

N1850 G0 G40 G603 G641 Z=WHEEL_HEIGHT+210
N1860 X=447.77+0.3-16 Z=WHEEL_HEIGHT+10

;N1865 G96 M3 M42  S=125 LIMS=100

;************************************************
;OT YABLOKA_2
;************************************************
N1870 OFFN=GLOBAL_ALLOWANCE
N1880 G1 G41 X=447.77+YABLOKO_NAR+0.3-1 Z=WHEEL_HEIGHT F=0.6 M7 M8 
N1890 X=447.77+YABLOKO_NAR-1 Z=WHEEL_HEIGHT-0.3
N1900 X=441.25+YABLOKO_NAR Z=119.000 F=1.1
N1910 G3 X=403.533 Z=90.126+DISK_NAR CR=50 F=1.0
N1920 G1 X=346.301 Z=80.982+DISK_NAR F=1.2
N1930 X=304.069 Z=74.235+DISK_NAR+0.3 F=1.25      ;+0.5

N1940 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200



;************************************************
;MOVE TO OUTER BOTTOM #2
;************************************************
N1950 G96 M3 M42  S=140 LIMS=110
N1960 G60 X=158.5+40 Z=122+15

;************************************************
;TORCOVKA STUPICY 1
;************************************************
N1970 OFFN=8
N1980 G1 G41 X=158.5+20 Z=122 F=1.0 M8
N1990  X=BORE_DIAM-10 Z=122 F=0.8 ; F=1.1

N2000 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(8)
N2010  X=158.5+40 Z=122+15

;************************************************
;TORCOVKA STUPICY 2
;************************************************
N2020 OFFN=3
N2030 G1 G41 X=158.5+20 Z=122 F=1.0 M8
N2040  X=BORE_DIAM-10 Z=122 F=1.0

N2050 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3)

N2060  X=158.5+7  Z=122+7

;************************************************
;OT STUPICY 
;************************************************
N2070 G96 M3  S=170 LIMS=120
N2080 OFFN=0
N2090 OFFN=6+GLOBAL_ALLOWANCE
N2100 G1 G42 X=158.5 Z=122.0 F=1.2 M7M8
N2110    X=165.989 Z=101.422 F=1.2
N2120 G2 X=231.836 Z=62.695 CR=60  F=0.9 ;F=1.3
N2130 G1 X=289.069 Z=71.839  F=1.0 ;F=1.2


N2140 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2150 Z=122.0+GLOBAL_ALLOWANCE+50
N2160 X=BORE_DIAM-20
N2170 G60 Z=122.0+GLOBAL_ALLOWANCE
N2180 STOPRE

;****************************
;OT STUPICY # 2
;****************************
N2190 G96 S=190 M3
N2200 LIMS=120

N2210 M816 M28
N2220 OFFN=GLOBAL_ALLOWANCE
N2230 G1 G42 X=BORE_DIAM-12 Z=122.0 F=1.1 M7M8
N2240 X=154.99+STUPICA_NAR Z=122.0 F=1.1
N2250 G3 X=159.6974+STUPICA_NAR Z=118.7101 CR=5 F=0.85
N2260 G1 X=165.989+STUPICA_NAR Z=101.422  F=0.95 ;F=1
N2270 G2 X=231.836 Z=62.695+DISK_NAR CR=60 F=0.95 ; F=1.2
N2280 G1 X=346.3013 Z=80.982+DISK_NAR+0.1 F=0.95

;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2290 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2300  G153 D0 Z=700
N2310  G60 G153 X=1000 M9


N2320 T5 D1
N2330 M6
N2340 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
N2350  M42
N2360  M3 G97 S=160 LIMS=180
;-----------------------------
;N2370   GOTOF RASTOCHKA_2
;------------------------------
N2370 G97 M3 S=130

N2380 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=122+GLOBAL_ALLOWANCE+15


N2390 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-6+0.5 Z=122+GLOBAL_ALLOWANCE+3 F=0.9 M7 M8
N2400 Z=-47.5-10 F=0.95


N2410 M23 G0 G40 X=IC(-4) 
N2420 Z=122+GLOBAL_ALLOWANCE+5 M9

;***********************
N2430 RASTOCHKA_2:
;***********************
N2440      G97 M3 S=160
N2450 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+5

N2460 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+3 F=1.2 M7 M8
N2470       M858
N2480 Z=-47.5+1.5 F=1.05
N2490 Z=-47.5-10 F=1.05 M200 M23
N2500 X=BORE_DIAM-GLOBAL_ALLOWANCE+2.4 F=3
N2510 G4S6



N2520 G0 G40 X=IC(-4)
N2530 Z=122+GLOBAL_ALLOWANCE+5 M9
N2540 X=BORE_DIAM-GLOBAL_ALLOWANCE+1

N2550 G1 X=BORE_DIAM+GLOBAL_ALLOWANCE+1 Z=122+GLOBAL_ALLOWANCE F=1
N2560 X=BORE_DIAM+GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE-1 F=0.5
N2570 G4S2
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N2580 G0 G40 Z=IC(50)
N2590 SUPA D0 X=1000 Z=800
N2600 G97 M3 S=5
N2610  M41
N2620     G4 F3
N2630  SPOS=227
N2640       M5
N2650      G4 F3
N2660  M52
N2670 T125
N2680 M6
N2690 D1
N2700 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N2710 M2
