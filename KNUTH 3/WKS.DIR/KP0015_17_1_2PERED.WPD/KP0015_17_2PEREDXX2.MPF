
;************************************************
;KNUT MFD
;Wheel: KP-0015-17, d=1066.8
;last change: 26.09.2017 by DIS
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0015_17_MA4_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********

N50 T20
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M42 M3 S10
N100 M0
N110 G97 M3 S65
N120 DIAMOF
N130 G0 G40 G54 X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+5
;****************
;OBOD
;****************
N140  G97 M3 S=40
N150  LIMS=50
N160 OFFN=GLOBAL_ALLOWANCE+TREAD_ALLOWANCE
N170 G1 G41 X=TREAD_DIAM+30 Z=WHEEL_HEIGHT-0.4 F=1.6 M8 
N180  X=466.4-3 Z=WHEEL_HEIGHT-0.4 F=1.6

N190 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(1)
N200  X=TREAD_DIAM+8-$P_TOOLR-2.5
;************************************************
;CHERNOVOY PO GREBNU
;************************************************
N210 OFFN=GLOBAL_ALLOWANCE+TREAD_ALLOWANCE
N220 G1 G42 X=TREAD_DIAM+5.45 Z=WHEEL_HEIGHT F=2 M8 S=39
N230    X=TREAD_DIAM+10.309 Z=WHEEL_HEIGHT-0.291-0.2 F=1
N240 G3 X=TREAD_DIAM+19.064 Z=TREAD_HEIGHT_S1+67.849-0.2 CR=28.794 F=1.3
N245    X=TREAD_DIAM+25.453-0.2 Z=TREAD_HEIGHT_S1+64.345-0.2 CR=26.114
N247    X=TREAD_DIAM+28.668-0.2 Z=TREAD_HEIGHT_S1+60.986 CR=13.458
N248    X=TREAD_DIAM+30-0.2 Z=TREAD_HEIGHT_S1+56.566 CR=8
N250 G1 X=TREAD_DIAM+30-0.2 Z=TREAD_HEIGHT_S1+56.24
N260 G3 X=TREAD_DIAM+28.116-0.35 Z=TREAD_HEIGHT_S1+50.231 CR=10.525
N270    X=TREAD_DIAM+18.352-0.35 Z=TREAD_HEIGHT_S1+42.692 CR=20.5
N280 G1 X=TREAD_DIAM+12.015-0.32 Z=TREAD_HEIGHT_S1+40.365 F=0.8
N290 G2 X=TREAD_DIAM+4.311-0.5 Z=TREAD_HEIGHT_S1+32.733+0.3 CR=13.044 F=0.8
N300    X=TREAD_DIAM+2.773-0.3 Z=TREAD_HEIGHT_S1+27.681 CR=40
N310    X=TREAD_DIAM+1.192-0.3 Z=TREAD_HEIGHT_S1+18.175-0.3 CR=74.798
N320 G4 S1
N770 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N780  X=TREAD_DIAM+40 Z=TREAD_HEIGHT_S1+15
N790  Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO GREBNU
;************************************************
N800 G0 G40 X=466.4-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N810 G97 M3 M42 S=70
N820 G95 LIMS=80
N830 G0 Z=WHEEL_HEIGHT+10
N840 G0 G60 Z=WHEEL_HEIGHT

N850 OFFN=0
N860 G1 G42 X=466.4-1 Z=WHEEL_HEIGHT F=1.5
N870 X=TREAD_DIAM+5.45 Z=WHEEL_HEIGHT 
N880 X=TREAD_DIAM+10.309 Z=WHEEL_HEIGHT-0.291 
N240 G3 X=TREAD_DIAM+19.064 Z=TREAD_HEIGHT_S1+67.849+0.05 CR=28.794 
N245    X=TREAD_DIAM+25.453 Z=TREAD_HEIGHT_S1+64.345+0.05 CR=26.114
N247    X=TREAD_DIAM+28.668 Z=TREAD_HEIGHT_S1+60.986 CR=13.458
N248    X=TREAD_DIAM+30 Z=TREAD_HEIGHT_S1+56.566 CR=8
N250 G1 X=TREAD_DIAM+30 Z=TREAD_HEIGHT_S1+56.24+0.1 F=1.2
N260 G3 X=TREAD_DIAM+28.116 Z=TREAD_HEIGHT_S1+50.231+0.15 CR=10.525
N270    X=TREAD_DIAM+18.352 Z=TREAD_HEIGHT_S1+42.692+0.15 CR=20.5
N280 G1 X=TREAD_DIAM+12.015 Z=TREAD_HEIGHT_S1+40.365+0.3 F=0.65
N290 G2 X=TREAD_DIAM+4.311-0.26 Z=TREAD_HEIGHT_S1+32.733+0.35 CR=13.044
N300    X=TREAD_DIAM+2.773-0.15 Z=TREAD_HEIGHT_S1+27.681+0.05 CR=40 F=0.8
N310    X=TREAD_DIAM+1.192-0.15 Z=TREAD_HEIGHT_S1+18.175 CR=74.798
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N950 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N960  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N970  Z=WHEEL_HEIGHT+150 ADISPOS=25
;*******************************
;PEREMESCHENIE K STUPICE
;*******************************
N280 G96 M3  S=120 LIMS=120
N290 G0 D1 X=168.275+15 Z=WHEEL_HEIGHT+44.76+GLOBAL_ALLOWANCE+TREAD_ALLOWANCE
;************************************************
;TORCOVKA STUPICY
;************************************************
N300 OFFN=GLOBAL_ALLOWANCE+0.3
N310 G1 G41 X=168.275 Z=WHEEL_HEIGHT+44.76+VYLET_ST F=1.2 M7 M8
N320 X=BORE_DIAM-3 Z=WHEEL_HEIGHT+44.76+VYLET_ST F=1.2
;******************************************************
N330 G0 G40 G603 G641 Z=WHEEL_HEIGHT+44.76+VYLET_ST+50

N610  G153 D0 Z=700
N620  G153 G60 X=1000 M60 M9
     M5
N630 T51
N640 M6
N650 DIAMOF
;**********************************
N980 G0 G40 X=-168.275 
N990 Z=WHEEL_HEIGHT+44.76+VYLET_ST+3
;************************************************
;VITOCHKA PO STUPICE, #1
;************************************************
N1000 G97 M4 S=120
N1010 LIMS=120

N1020 OFFN=GLOBAL_ALLOWANCE
N1030 G1 G41 X=-168.275-1 Z=WHEEL_HEIGHT+44.76 F=0.8 M7 M8
N1040 X=-168.275-1 Z=WHEEL_HEIGHT+5.14+3 F=0.7
N1050 G3 X=-177.275 Z=WHEEL_HEIGHT-2.85+3 CR=8 F=0.4
N1080 G1 X=-177.275-5 Z=WHEEL_HEIGHT-2.85+3 F=1.1

N980 G0 G40 Z=WHEEL_HEIGHT+44.76+VYLET_ST+50

N980 G0 G40 X=-BORE_DIAM+5
N990 Z=WHEEL_HEIGHT+44.76+VYLET_ST+1
;************************************************
;VITOCHKA PO STUPICE
;************************************************
N1000 G97 M4 S=130
N1010 LIMS=130

N1020 OFFN=GLOBAL_ALLOWANCE
N1030 G1 G41 X=-BORE_DIAM+7 Z=WHEEL_HEIGHT+44.76+VYLET_ST F=1.2 M7 M8
N1040 X=-166.775-STUPICA_VNUT Z=WHEEL_HEIGHT+44.76+VYLET_ST F=0.5
N1050 X=-168.275-STUPICA_VNUT Z=WHEEL_HEIGHT+43.26+VYLET_ST F=0.2
N1060 X=-168.275-STUPICA_VNUT Z=WHEEL_HEIGHT+5.14 F=0.2 M23
N1070 G3 X=-176.265-STUPICA_VNUT Z=WHEEL_HEIGHT-2.7 CR=7.99 F=0.3
N1080 G1 X=-180.84-2 Z=WHEEL_HEIGHT-2.7 F=0.3

N1090 G0 G40 G603 G641 Z=WHEEL_HEIGHT+44.76+50
N1100 G97  M4 S200 LIMS=200 M23
N1110  G153 D0 Z=800
N1120  G60 G153 X=1000 
;************************************************
;MACHINING CH1 FINISHED, WAIT FOR FINISHING CH2
;************************************************
N1130 G4 F1
N1140 M9
N1150 SPOS=254
N1160    M5
N1170 G4F4
N1180 M52 

N1340 T20
N1350 M6

N1190 M56
N1200 MSG("OBRABOTKA V/S ZAVERSHENA")
;*********************
;*POSICITION N/S*
;*********************
N1210 M0

N1220 M51
N1230 G97 M41 M3 S5
N1240 SPOS=116
N1250 M5
N1260 G4F4
N1270 M52

N1340 T20
N1350 M6
N1360 DIAMOF

N1280 MSG("ZAGRUZKA N/S")
N1290 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1300 G18 G90 G95 F=1.2

N1310   N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1320 M51 
N1330    M56

;CALL ZERO POINT SHIFT
N1370 G55
N1380 DIAMOF
N1390  G97 M41 M3 S=10
N1400 M0
N1410 G97 M41 M3 S37
N1420 G0 G40 X=TREAD_DIAM+7 Z=WHEEL_HEIGHT

N1430  G95 LIMS=32
;************************************************
;TORCOVKA OBODA
;************************************************
N1440 OFFN=GLOBAL_ALLOWANCE
N1450 G1 G41 X=TREAD_DIAM Z=WHEEL_HEIGHT F=1.2  M8
N1460 X=466.4-5 Z=WHEEL_HEIGHT  F=1.3

N1470 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(2.0)
N1480 X=TREAD_DIAM
;************************************************
;CHERNOVOY PO KRUGU KATANIYA
;************************************************
N1490 OFFN=TREAD_ALLOWANCE+GLOBAL_ALLOWANCE
N1500 G1 G42 X=TREAD_DIAM-9.167-0.32 Z=WHEEL_HEIGHT F=0.8 M8 S=38
N1510    X=TREAD_DIAM-4.167-0.32 Z=WHEEL_HEIGHT-5
N1520 G2 X=TREAD_DIAM-0.975-0.32 Z=TREAD_HEIGHT_S2+24 CR=3885.3 F=1
N1530 G3 X=TREAD_DIAM-0.32 Z=TREAD_HEIGHT_S2 CR=1127.03
N1540 G2 X=TREAD_DIAM+1.192-0.3 Z=TREAD_HEIGHT_S2-18.175 CR=233.55
;N1550 G2 X=TREAD_DIAM+2.218-0.3 Z=TREAD_HEIGHT_S2-25.097 CR=74.798
N1560 G4 S1

N1570 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1580  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10
N1590 G60 X=TREAD_DIAM Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO KRUGU KATANIYA
;************************************************
N1600 OFFN=GLOBAL_ALLOWANCE
N1610 G0 G40 X=TREAD_DIAM Z=WHEEL_HEIGHT+50

N1620 G97 M3 S=68
N1630 G95 LIMS=80

N1640 G0 Z=WHEEL_HEIGHT+5

N1650 G1 G42 X=TREAD_DIAM-9.167-1 Z=WHEEL_HEIGHT+1 F=1.3 M8
N1660    X=TREAD_DIAM-4.167 Z=WHEEL_HEIGHT-5
N1670 G2 X=TREAD_DIAM-0.975 Z=TREAD_HEIGHT_S2+24 CR=3885.3 F=1.5
N1530 G3 X=TREAD_DIAM Z=TREAD_HEIGHT_S2 CR=1127.03
N1540 G2 X=TREAD_DIAM+1.192+0.1 Z=TREAD_HEIGHT_S2-18.175 CR=233.55
N1550 G2 X=TREAD_DIAM+2.773+0.17 Z=TREAD_HEIGHT_S2-27.681 CR=74.798

N1710 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1720  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10
;************************************************
;TOOL CHANGE T77
;************************************************
N1730 SUPA G0 G40 D0 X=1000 Z=700  OFFN=0 M9

N1740 T77
N1750 M6
N1760 DIAMOF
;************************************************
;KANAVKA, 2 CUTS
;NOTE: R2 ALTERED TO R1.59 (=$P_TOOLR)
;************************************************
N1320 G0 G40 D1 X=482.6-1.6 M8

N1340 Z=WHEEL_HEIGHT+2+GLOBAL_ALLOWANCE

;---CUT#1---
N1350 G97 M3 S=65
N1460 G1 G95 X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE+0.8+1 F=5.2
N1465  X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE+1 F=1
N1467  X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE-1.6+1 F=0.2
N1500 G4S1
N1510 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE+1

;---CUT#2---
N1440 OFFN=0
N1460 G1 G95 X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE+0.95 F=5.2
N1465     X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE+0.15 F=1
N1467     X=482.6-1.6 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE-1.6 F=0.2
N1500 G4S1
N1510 Z=WHEEL_HEIGHT+GLOBAL_ALLOWANCE

N1530 G0 G40 Z=IC(GLOBAL_ALLOWANCE+5)
;************************************************
N1970 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1980  G153 D0 Z=700
N1990  G60 G153 X=1000 M9
      M5
N2000 T5 D1
N2010 M6
N2020 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
N2025  M42
N2030  M3 G97 S=193 LIMS=220
N2040 G0 G40 G95 X=BORE_DIAM-10 Z=114+15 

N2250 G1 X=BORE_DIAM Z=116.37+1 F=0.8 M8
N2260  Z=-44.76-1.5 F=0.8
N2270  Z=-44.76-10 F=0.8 M23
N2280  X=BORE_DIAM+2.3 F=1.2
N2290 G4 S2

N2300 G0 G40 X=IC(-8)
N2310    Z=116.37+1+5
N2320    X=BORE_DIAM+1.25

N2330 G1 X=BORE_DIAM+1.25 Z=116.37+0.5+1.5 F=1
N2340  X=BORE_DIAM-0.5 Z=116.37-1.25+1.5 F=0.5 M9
N2350 G4S1
N2360 G97 M3 S=200
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N2370 G0 G40 Z=IC(50)
N2380 SUPA D0 X=1000 Z=800
N2390 G97 M3 S=20
N2400 M41
N2410 G4 F1
N2420 SPOS=116
N2430 M5
N2440 G4 F3
N2450 M52


N50 T20
N60 M6
N70 D1
N80 DIAMOF



;*********************
;*END OF PROGRAM*
;*********************
N2460 M2
