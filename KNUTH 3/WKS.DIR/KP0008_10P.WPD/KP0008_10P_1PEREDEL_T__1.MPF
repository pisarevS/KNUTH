

;************************************************
;KNUT MFD
;Wheel: KP-0008-10 MAVRITANIYA 1076 NORMA-6.5
;last change: 11.03.2016 by DIS
;************************************************
;PROGRAM-TYPE: Machining Program
;MACHINING SIDE: 1
;************************************************
N10 G18 G90 G95 F=1.2

N20 CALL "KP0008_10P_MA3_PARAMETER_SPF"
N30    N_PREPARE_FOR_MACHINING
;********
N40 M51 M56
;********
;* INIT *
;********
N50 T125
N60 M6
N70 D1
N80 DIAMOF
N90 G97 M41 M3 S10
N100 M0
N120 DIAMOF
N130 G0 G40 G54 X=TREAD_DIAM+29+10 Z=WHEEL_HEIGHT+6 S=30
;****************
;OBOD
;****************
N140  G96 M3 S=115
;N150  LIMS=40
N160 OFFN=0.2
N170 G1 G41 X=TREAD_DIAM+40 Z=WHEEL_HEIGHT F=1.7 M8 
N180  X=444+55 Z=WHEEL_HEIGHT F=1.2
N180  X=444-5 Z=WHEEL_HEIGHT F=1.45

N190 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(1)
N200  X=TREAD_DIAM+29
;************************************************
;CHERNOVOY PO GREBNU, #1 CUT
;************************************************

N210       GOTOF CUP_2

N220 OFFN=0.2
N230 G1 G42 X=TREAD_DIAM+29 Z=WHEEL_HEIGHT F=1.5 S=30
N240  X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966+5 F=1.23
N250 G1 X=TREAD_DIAM+29 Z=TREAD_HEIGHT_S1+54.966 F=1.23
;  PATH CTRL MODE TO CUT#2
N260 G0 G40 G603 G641 ADISPOS=15
N270  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
N280 G60 X=TREAD_DIAM+18.202-$P_TOOLR-0.5-3.5 Z=WHEEL_HEIGHT+2
;************************************************
;CHERNOVOY PO GREBNU, #2 CUT
;************************************************

N290             CUP_2:

G97 M3 S=35
N300 OFFN=0.2
N310 G1 G42 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT F=2 M8 S=35
N320        X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.726 F=1.3
N330 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6   F=1.3
N340 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.939
;************************************************
;PATH-CTRL-MODE TO INNER HUB FACE
;************************************************
N350 G0 G40 G603 G641 ADISPOS=10 OFFN=0
N360  X=TREAD_DIAM+50 Z=WHEEL_HEIGHT+10
;*******************************
;PODHOD K YABLOKU
;*******************************
N370 G96 M3 S=120 LIMS=75 
N380 G0 G40 X=444-10 M9

     ;GOTOF YABL_2

N390 OFFN=GLOBAL_ALLOWANCE+5
N400 G1 G41 X=444.0 Z=WHEEL_HEIGHT F=1 M7 M8
N410 Z=WHEEL_HEIGHT-4.5 F=1.2
N420 G3 X=384.091 Z=WHEEL_HEIGHT-53.508 CR=50 F=1.3
N430 G1 X=330.0 Z=WHEEL_HEIGHT-42.572 F=1.4
N440 X=300.0 Z=WHEEL_HEIGHT-36.507+0.5 F=1.4
N450 G4S2


N460 G0 G40 G603 G641 Z=WHEEL_HEIGHT+180
N470 G60 X=446.3-16 Z=WHEEL_HEIGHT+10

N480     YABL_2:

;************************************************
; CHERNOVOY PROHOD ##### OT YABLOKA #2
;************************************************

N490 OFFN=GLOBAL_ALLOWANCE
N500 G1 G41 X=444.0+2.3+YABLOKO_VNUT Z=WHEEL_HEIGHT F=1 M7 M8
N510 G1 X=444.0+YABLOKO_VNUT Z=WHEEL_HEIGHT-2.3 F=1.2
N520 G3 X=384.091 Z=WHEEL_HEIGHT-53.508+DISK_VNUT CR=50
N530 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT  
N540 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT+0.3


N550 G0 G40 G603 G641 Z=WHEEL_HEIGHT+80+150 
N560 G96 M3 M42 S=80 LIMS=125
;************************
;TORCOVKA STUPICY
;************************
N570 G60 X=157.02+40 Z=WHEEL_HEIGHT+47.5

N580 OFFN=0
N590 G96 M3 S=95 LIMS=125
N600 OFFN=GLOBAL_ALLOWANCE
N610 G1 G41 X=157.02+10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.63 M7 M8
N620 X=BORE_DIAM-10 Z=WHEEL_HEIGHT+47.5+VYLET_ST F=0.58; F=0.8
N630 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(4)  M9

N640 G0 G40 X=157.02+10

N650 G96 M3 S=150 LIMS=120

 ;GOTOF STUP_2

;************************************************
;OT STUPICY 1
;************************************************

N660 OFFN=8+GLOBAL_ALLOWANCE
N670 G1 G42 X=157.02 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N680 X=167.160 Z=WHEEL_HEIGHT+19.64 F=0.7 ; F=1.1
N690 G2 X=211.652 Z=WHEEL_HEIGHT-18.646 CR=60  F=0.75 ;F=1.3
N620 G1 X=330.0-28 Z=WHEEL_HEIGHT-42.572+2.7 F=0.98    ;;;;ZAKRIT' ETOT KADR ESLI PO DISKU MALO BERET

N700 G0 G40 G603 G641 Z=WHEEL_HEIGHT+47.5+VYLET_ST+250
N710 X=157.02+16 Z=WHEEL_HEIGHT+47.5+VYLET_ST+15

;************************************************
;CHERNOVOY OT STUPICY,## 2CUT
;************************************************

N720     STUP_2:

N730 G96 M3 S=130 LIMS=110

N740 OFFN=GLOBAL_ALLOWANCE
N750 G1 G42 X=157.02-0.3+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5 F=1.0 M7 M8
N760 X=157.02+STUPICA_VNUT+0.5+1 Z=WHEEL_HEIGHT+47.5-0.3 F=0.3
N770 X=167.160+STUPICA_VNUT+0.5 Z=WHEEL_HEIGHT+19.64 F=0.8
N780 G2 X=211.652 Z=WHEEL_HEIGHT-18.646+DISK_VNUT CR=60  F=0.85 ;F=1.1
;     G1 X=315 Z=WHEEL_HEIGHT-39.540+DISK_VNUT
N790 G1 X=330.0 Z=WHEEL_HEIGHT-42.572+DISK_VNUT+0.15 F=1.0

;************************************************
;PATH-CTRL-MODE TO LOADING POSITION
;************************************************
N800 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N810  G153 D0 Z=700
N820  G153 G60 X=1000 M60 M9
M5
N830 T20
N840 M6
N850 DIAMOF
;*********************
;PROHOD POD GREBENJ
;*********************
N860 G0 G40 M41 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651+5

N870 G97 M3 S=38
N880 G95 LIMS=RTOI(75/(2*3.14*(TREAD_DIAM+30)/1000))
N890    OFFN=0.15
N900 G1 G42 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651  F=1.2   M8
N910 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N920 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=0.85
N930 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 F=0.75 
N940 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N950     G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34
N960 G4 S1
N970 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N980  X=TREAD_DIAM+32 Z=TREAD_HEIGHT_S1+15.150
N990  Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO GREBNU
;************************************************
N1000 G0 G40 X=444.0-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N1010 G96 M3 M42 S=65
N1020 G95 LIMS=RTOI(120/(2*3.14*(TREAD_DIAM+30)/1000))
N1030 G0 Z=WHEEL_HEIGHT+10
N1040 G0 G60 Z=WHEEL_HEIGHT

N1050 OFFN=0
N1060 G1 G42 X=444.0 Z=WHEEL_HEIGHT F=1.5 M8 S=70
N1070 X=TREAD_DIAM+8.2058 Z=WHEEL_HEIGHT
N1080 X=TREAD_DIAM+16.6112 Z=WHEEL_HEIGHT-1.7695 F=1
N1090 G3 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+54.9651 CR=15.6
N1100 G1 X=TREAD_DIAM+28.9975 Z=TREAD_HEIGHT_S1+53.9383
N1110 G3 X=TREAD_DIAM+18.7329 Z=TREAD_HEIGHT_S1+39.2791 CR=15.6 F=1
N1120 G1 X=TREAD_DIAM+11.8 Z=TREAD_HEIGHT_S1+36.7557 
N1130 G2 X=TREAD_DIAM+4.7853 Z=TREAD_HEIGHT_S1+30.6575 CR=17
N1140 G2 X=TREAD_DIAM+0.8177 Z=TREAD_HEIGHT_S1+16.3548 CR=34
N1150 G97  M3 S200 LIMS=200 M23
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N1160 G0 G40 G603 G641 ADISPOS=5 OFFN=0 
N1170  X=TREAD_DIAM+50 Z=TREAD_HEIGHT_S1+15.150
N1180  G153 D0 Z=800
N1190  G60 G153 X=1000 
;************************************************
;MACHINING CH1 FINISHED, WAIT FOR FINISHING CH2
;************************************************
N1200 G4 F6
N1210 M9
N1220 SPOS=254
N1230    M5
N1240 G4F4
N1250 M52 

N1260 M56
N1270 MSG("OBRABOTKA V/S ZAVERSHENA")
;*********************
;*POSICITION N/S*
;*********************
N1280 M0

N1290 M51
N1300 G97 M41 M3 S5
N1310 SPOS=116
N1320 M5
N1330 G4F4
N1340 M52

N1350 MSG("ZAGRUZKA N/S")
N1360 M0
;************************************************
;NARUGNAYA STORONA
;************************************************
N1370 G18 G90 G95 F=1.2

N1380   N_PREPARE_FOR_MACHINING
;********
;* INIT *
;********
N1390 M51 
N1400    M56

N1410 T20
N1420 M6
N1430 DIAMOF

;CALL ZERO POINT SHIFT
N1440 G55
N1450 DIAMOF
N1460  G97 M41 M3 S=10
N1470 M0
N1480 G97 M41 M3 S35
N1490 G0 G40 X=TREAD_DIAM+13 Z=WHEEL_HEIGHT


;N1500  G95 LIMS=20
;************************************************
;TORCOVKA OBODA
;************************************************

G96 M3 S=120
N1510 OFFN=0.2
N1520 G1 G41 X=TREAD_DIAM Z=WHEEL_HEIGHT F=1.2  M8
N1530 X=444+40 Z=WHEEL_HEIGHT  F=1.2
N1530 X=444-10 Z=WHEEL_HEIGHT  F=1.5

N1540 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(2.0)
N1550 X=TREAD_DIAM
;************************************************
;CHERNOVOY PO KRUGU KATANIYA
;************************************************
N1560 OFFN=0.22
N1570 G1 G42 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1 M7 M8
N1580    X=TREAD_DIAM Z=WHEEL_HEIGHT-5

N1590         GOTOF K_K


N1600    X=TREAD_DIAM Z=TREAD_HEIGHT_S2
N1610    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354
N1620   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34
N1630 G4 S1


N1640         K_K:


N1650 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N1660  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10
N1670 G60 X=TREAD_DIAM-10 Z=WHEEL_HEIGHT+50
;************************************************
;CHISTOVOY PO KRUGU KATANIYA
;************************************************
N1680 OFFN=GLOBAL_ALLOWANCE
N1690 G0 G40 X=440-$P_TOOLR-7.5 Z=WHEEL_HEIGHT+50

N1700 G97 M3 S=65
;N1710 G95 LIMS=RTOI(165/(2*3.14*TREAD_DIAM/1000))

N1720 G0 Z=WHEEL_HEIGHT+10

N1730      G1 G42 X=444-5 Z=WHEEL_HEIGHT F=1.1
N1740 G1 X=TREAD_DIAM-5 Z=WHEEL_HEIGHT F=1.1 M7 M8
N1750    X=TREAD_DIAM-1 Z=WHEEL_HEIGHT-5 S=35
N1760    X=TREAD_DIAM Z=TREAD_HEIGHT_S2
N1770    X=TREAD_DIAM+0.817 Z=TREAD_HEIGHT_S2-16.354
N1780   G2 X=TREAD_DIAM+2.867 Z=TREAD_HEIGHT_S2-26.38 CR=34


N1790 G0 G40 G603 G641 ADISPOS=25 OFFN=0 S=20
N1800  X=TREAD_DIAM+25 Z=WHEEL_HEIGHT+10

;************************************************
;TOOL CHANGE T125
;************************************************
N1810 SUPA G0 G40 D0 X=1000 Z=700  OFFN=0 M9

;N1820 M5
N1830 T125
N1840 M6
N1850 DIAMOF
;************************************************
;OT YABLOKA_1
;************************************************
N1860 G96 M3 S=106 LIMS=85
N1870 G0 G40  X=444-$P_TOOLR Z=WHEEL_HEIGHT+8

N1880 OFFN=6+GLOBAL_ALLOWANCE
N1890 G1 G41 X=447.77 Z=WHEEL_HEIGHT F=1.0 M7 M8 
N1900 X=441.25 Z=119.000 F=1.0
N1910 G3 X=403.533 Z=90.126 CR=50 F=0.8
N1920 G1 X=289.069 Z=71.839 F=0.86
N1930 G4S1 

N1940 G0 G40 G603 G641 Z=WHEEL_HEIGHT+210
N1950 X=447.77+0.3-16 Z=WHEEL_HEIGHT+10



;************************************************
;OT YABLOKA_2
;************************************************
N1960 OFFN=GLOBAL_ALLOWANCE
N1970 G1 G41 X=447.77+YABLOKO_NAR+0.3-1 Z=WHEEL_HEIGHT F=0.9 M7 M8 
N1980 X=447.77+YABLOKO_NAR-1 Z=WHEEL_HEIGHT-0.3
N1990 X=441.25+YABLOKO_NAR Z=119.000 F=1.05
N2000 G3 X=403.533 Z=90.126+DISK_NAR CR=50 F=1.1
N2010 G1 X=346.301 Z=80.982+DISK_NAR F=1.1
N2020 X=304.069 Z=74.235+DISK_NAR+0.3 F=1.1      ;+0.5

N2030 G0 G40 G603 G641 Z=WHEEL_HEIGHT+200



;************************************************
;MOVE TO OUTER BOTTOM #2
;************************************************
N2040 G96 M3 M42 S=105 LIMS=130
N2050 G60 X=158.5+28 Z=122+15

;************************************************
;TORCOVKA STUPICY 1
;************************************************
N2060 OFFN=6
N2070 G1 G41 X=158.5+20 Z=122 F=1.0 M8
N2080  X=BORE_DIAM-10 Z=122 F=1 ; F=1.1

N2090 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(8)
N2100  X=158.5+28 Z=122+15

;************************************************
;TORCOVKA STUPICY 2
;************************************************
N2110 OFFN=0
N2120 G1 G41 X=158.5+20 Z=122 F=1 M8
N2130  X=BORE_DIAM-10 Z=122 F=0.8

N2140 G0 G40 X=IC($P_TOOLR*(-1)) Z=IC(3)

N2150  X=158.5+7  Z=122+7

;************************************************
;OT STUPICY 
;************************************************
N2160 G96 M3  S=152 LIMS=120
N2170 OFFN=0
N2180 OFFN=6+GLOBAL_ALLOWANCE
N2190 G1 G42 X=158.5 Z=122.0 F=1 M7M8
N2200    X=165.989 Z=101.422 F=1
N2210 G2 X=231.836 Z=62.695 CR=60  F=0.8 ;F=1.3
N2220 G1 X=289.069 Z=71.839  F=0.9 ;F=1.2


N2230 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2240 Z=122.0+GLOBAL_ALLOWANCE+50
N2250 X=BORE_DIAM-20
N2260 G60 Z=122.0+GLOBAL_ALLOWANCE
N2270 STOPRE

;****************************
;OT STUPICY # 2
;****************************
N2280 G96 S=156 M3
N2290 LIMS=120

N2300 M816 M28
N2310 OFFN=GLOBAL_ALLOWANCE
N2320 G1 G42 X=BORE_DIAM-12 Z=122.0 F=1.1 M7M8
N2330 X=154.99+STUPICA_NAR Z=122.0 F=1.55
N2340 G3 X=159.6974+STUPICA_NAR Z=118.7101 CR=5 F=0.66
N2350 G1 X=165.989+STUPICA_NAR Z=101.422  F=0.9 ;F=1
N2360 G2 X=231.836 Z=62.695+DISK_NAR CR=60 F=0.9 ; F=1.2
N2370 G1 X=346.3013 Z=80.982+DISK_NAR+0.1 F=0.95

;************************************************
;MOVE TO LOADING POSITION/WAIT FOR CH1
;************************************************
N2380 G0 G40 G603 G641 ADISPOS=25 OFFN=0
N2390  G153 D0 Z=700 
N2400  G60 G153 X=1000 M9

N2400 M5
N2410 M42
N2420 T5 D1
N2430 M6
N2440 DIAMOF
;************************************************
;RASTOCHKA STUPICY
;************************************************
;N2440  M42
N2450  M3 G97 S=160 LIMS=180
;-----------------------------
;N2370   GOTOF RASTOCHKA_2
;------------------------------
N2460 G97 M3 S=150

N2470 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE-7 Z=122+GLOBAL_ALLOWANCE+15


N2480 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE-6 Z=122+GLOBAL_ALLOWANCE+3 F=0.9 M7 M8
N2490 Z=-47.5-10 F=0.9


N2500 M23 G0 G40 X=IC(-4) 
N2510 Z=122+GLOBAL_ALLOWANCE+5 M9

;***********************
N2520 RASTOCHKA_2:
;***********************
N2530      G97 M3 S=150
N2540 G0 G40 G95 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+5

N2550 G1 X=BORE_DIAM-GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE+3 F=1.2 M7 M8
N2560       M858
N2570 Z=-47.5+1.5 F=0.9 M23
N2580 Z=-47.5-10 F=1.2 M200
N2590 X=BORE_DIAM-GLOBAL_ALLOWANCE+1.6 F=3
N2600 G4S6



N2610 G0 G40 X=IC(-4) 
N2620 Z=122+GLOBAL_ALLOWANCE+5 M9
N2630 X=BORE_DIAM-GLOBAL_ALLOWANCE+1

N2640 G1 X=BORE_DIAM+GLOBAL_ALLOWANCE+1 Z=122+GLOBAL_ALLOWANCE F=1
N2650 X=BORE_DIAM+GLOBAL_ALLOWANCE Z=122+GLOBAL_ALLOWANCE-1 F=0.5
N2660 G4S2
;************************************************
;PATH-CTRL-MODE TO TOOL CHANGE T1
;************************************************
N2670 G0 G40 Z=IC(50) S=20
N2680 SUPA D0 X=1000 Z=800
N2690 G97 M3 S=5
N2700  M41
N2710     G4 F3
N2720  SPOS=116
N2730       M5
N2740      G4 F3
N2750  M52
N2760 T125
N2770 M6
N2780 D1
N2790 DIAMOF
;*********************
;*END OF PROGRAM*
;*********************
N2800 M2
